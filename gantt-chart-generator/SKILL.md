---
name: gantt-chart-generator
description: プロジェクトのガントチャートをExcel形式で自動生成。契約書/提案書（docx/PDF）からプロジェクト情報を抽出、または自然言語でのタスク説明から生成可能。WBS形式の階層的タスク構造、ステータス変更でガントバーが自動更新される動的Excel、マイルストーン自動抽出・表示。Jony Iveデザイン。「ガントチャートを作成」「プロジェクトスケジュールをExcelで」「この契約書からガントチャートを生成」「タスクをWBSで整理してガント化」等のリクエストで使用。
---

# Gantt Chart Generator

## Overview

契約書/提案書または自然言語から、ステータス連動型ガントチャートをExcelで生成するスキル。2シート構成（プロジェクト概要＋タスク/ガントチャート統合）で出力。

## Workflow

1. **入力受付**: ファイル（docx/PDF）または自然言語
2. **情報抽出**: プロジェクト名、期間、フェーズ、タスク、マイルストーン、担当者
3. **WBS構造化**: 階層的な番号付け（1, 1.1, 1.1.1...）
4. **Excel生成**: `scripts/create_gantt.py`を実行
5. **出力**: `/mnt/user-data/outputs/`に出力

## Input Requirements

### パターンA: 契約書/提案書から
- docx/PDFファイルをアップロード
- 契約期間、納品日、検収日をマイルストーンとして抽出
- フェーズを推定してWBS構造化

### パターンB: 自然言語から
- ユーザーに以下を確認:
  - プロジェクト名
  - 開始日
  - タスク一覧（名前、担当、期間）
  - マイルストーン（任意）

## スクリプト実行方法

`scripts/create_gantt.py`の`PROJECT_DATA`セクションを編集して実行:

```python
PROJECT_DATA = {
    "project_name": "DXコンサルティングプロジェクト",
    "start_date": "2025-01-06",
    "responsible": "担当マネージャー",
    "phases": [
        {
            "name": "フェーズ1: 現状分析",
            "tasks": [
                {"name": "ヒアリング", "assignee": "田中", "days": 5},
                {"name": "業務フロー分析", "assignee": "佐藤", "days": 3},
            ],
            "milestone": {"name": "現状分析完了", "days_from_phase_start": 8}
        },
        {
            "name": "フェーズ2: 施策提案",
            "tasks": [
                {"name": "課題整理", "assignee": "田中", "days": 2},
                {"name": "提案書作成", "assignee": "全員", "days": 5},
            ],
            "milestone": {"name": "提案書提出", "days_from_phase_start": 7}
        }
    ]
}
```

実行:
```bash
python scripts/create_gantt.py
```

## Output Specification

### シート1: プロジェクト概要

| 項目 | 内容 |
|------|------|
| プロジェクト名 | 入力から取得 |
| 期間 | 開始日〜終了日（自動計算） |
| 責任者 | 入力から取得 |
| 主要フェーズ | フェーズ一覧 |
| マイルストーン | マイルストーン一覧と日付 |

### シート2: タスク（ガントチャート統合）

#### 列構成
| WBS | タスク名 | 担当 | 開始日 | 終了日 | 日数 | ステータス | W1 | W2 | W3 | ... |

#### ステータス
ドロップダウン選択式:
- 未着手
- 進行中
- 完了
- 保留

#### ガントバー
条件付き書式でステータス連動（グレー濃淡）:
- **未着手**: ペールグレー (#CCCCCC) - 控えめ
- **進行中**: ミディアムグレー (#666666) - 注目
- **完了**: ダークグレー (#333333) - 確定
- **保留**: ホワイト + 枠線 (#FFFFFF) - 空の状態

#### マイルストーン
- 「◆」マーカー、アクセントブルー背景 (#5B7B94) - 唯一の色

## デザイン仕様（Jony Iveデザイン哲学）

### デザイン原則
**"Simplicity is the ultimate sophistication"**

1. **極限までシンプルに** - 不要な装飾を排除
2. **余白を贅沢に使う** - 情報に呼吸する空間を
3. **完璧な整列** - すべての要素を精密に配置
4. **色で騒がない** - グレースケール基調、アクセント1色のみ
5. **階層の明確化** - 濃淡で重要度を表現

### 配色（グレースケール＋1アクセント）
- **タイトル**: ブラック (#000000)
- **本文**: ダークグレー (#333333)
- **見出し**: ミディアムグレー (#666666)
- **補足**: ライトグレー (#999999)
- **セパレーター**: (#E0E0E0)
- **フェーズ行背景**: 背景グレー (#F5F5F5)
- **ヘッダー背景**: ダークグレー (#333333)、白文字
- **アクセント**: (#5B7B94) - マイルストーンのみ

### フォント（すべてメイリオで統一）
- **タイトル**: 14pt、太字
- **フェーズ見出し**: 11pt、太字
- **ヘッダー**: 10pt、太字
- **本文**: 10pt
- **週番号**: 9pt

### レイアウト
- グリッド線: 非表示
- 罫線: 最小限（細いグレー）
- 週列幅: 狭め（3.5）でコンパクトに
- タスク名列: 広め（35）で可読性確保

## 数式設計

### ガントバー表示
```excel
=IF(AND(開始日<=週開始日, 終了日>=週終了日), "■", "")
```

### ステータス連動（条件付き書式）
```
ステータス列が「進行中」の場合、ガントバーセルを青に
```

### 日数計算
```excel
=終了日-開始日+1
```

### 週番号の自動生成
開始日から週単位でW1, W2, W3...を生成（最大24週）

## WBS番号の付与ルール

```
1         ← フェーズ
1.1       ← サブフェーズ（使用する場合）
1.1.1     ← タスク
1.1.2     ← タスク
2         ← フェーズ
2.1.1     ← タスク
MS1       ← マイルストーン
```

## Constraints & Boundaries

### DO
- ガントチャート生成
- WBS構造化
- ステータス連動数式
- 契約書/提案書からのマイルストーン自動抽出
- 自然言語からのタスク解釈

### DO NOT
- 契約書/提案書の作成（別スキルの役割）
- 議事録・進捗サマリーの生成（meeting-to-tasksheetの役割）
- 他システムとのリアルタイム連携

## Usage Examples

### 例1: 契約書から生成
```
User: 「この契約書からガントチャートを作って」
Claude: 契約書を読み込み、期間・フェーズ・マイルストーンを抽出してガントチャートを生成
```

### 例2: 自然言語から生成
```
User: 「来週月曜からヒアリング1週間、要件定義2週間、開発4週間、テスト1週間で進めたい」
Claude: タスクを抽出してWBS形式に整理し、ガントチャートを生成
```

### 例3: 詳細指定
```
User: 「プロジェクト名は『新規システム導入』、担当は田中さんで、
      12/2からヒアリング3日、その後要件定義5日、開発10日でお願い」
Claude: 指定された情報でガントチャートを生成
```

## Resources

### scripts/
- `create_gantt.py`: ガントチャート生成のメインスクリプト

### references/
- `gantt_format.md`: ガントチャートフォーマットの詳細説明
