---
name: billing-documents
description: 請求書・見積書を自動生成する統合スキル。【請求書】月額固定型、消費税10%自動計算、支払期限は請求月末。「請求書を作成」「インボイスが必要」で起動。【見積書】月額顧問型・時間単価型・プロジェクト型対応、有効期限自動設定。「見積書を作成」「見積もりが必要」で起動。Excel出力、Jony Iveデザインで統一。
---

# Billing Documents Generator

請求書・見積書を自動生成する統合スキル。

## トリガーワード判定

| キーワード | 生成物 | スクリプト |
|-----------|--------|-----------|
| 請求書、インボイス、請求、invoice | **請求書** | `create_invoice.py` |
| 見積書、見積もり、見積、quotation | **見積書** | `create_quotation.py` |

---

# Part 1: 請求書（Invoice）

## 概要

月額固定型の請求書を自動生成。Excel形式で出力。

## 使用方法

### 情報確認

ユーザーに以下を確認：
- 請求先企業名
- 業務内容（例: 生成AIアドバイザリー業務）
- 金額（税抜）
- 請求日（省略時は今日）
- 請求書番号（省略時は自動生成: INV-YYYYMM-XXX）

### スクリプト実行

```bash
python scripts/create_invoice.py
```

### カスタマイズ

`scripts/create_invoice.py`の`INVOICE_DATA`セクションを編集：

```python
INVOICE_DATA = {
    # 発行者情報（自社情報）
    "issuer_name": "株式会社けんけん",
    "issuer_address": "〒760-0000 香川県高松市○○町1-2-3",
    "issuer_tel": "087-123-4567",
    "issuer_email": "info@kenken.co.jp",
    
    # 振込先情報
    "bank_name": "○○銀行",
    "branch_name": "高松支店",
    "account_type": "普通",
    "account_number": "1234567",
    "account_holder": "カ)ケンケン",
    
    # 請求先・内容
    "client_name": "合同会社大吉",
    "description": "生成AIアドバイザリー業務",
    "amount": 200000,  # 税抜金額
}
```

## 請求書の構成

1. タイトル「請求書」
2. 請求書番号（INV-YYYYMM-XXX）
3. 発行日
4. 請求先（会社名 御中）
5. 請求金額（税込、大きく強調）
6. 明細表（品名、数量、単価、金額）
7. 小計・消費税(10%)・合計
8. 支払期限（請求月末）
9. 発行者情報
10. 振込先情報
11. 備考

## 金額計算

- 消費税: 10%（端数切り捨て）
- 支払期限: 請求日の月末

## 出力ファイル

- `請求書_INV-YYYYMM-XXX.xlsx`

※ PDF送付が必要な場合は、Excelで開いて印刷メニューからPDF保存してください。

詳細は `references/invoice_format.md` を参照。

---

# Part 2: 見積書（Quotation）

## 概要

見積書を自動生成。月額顧問型、時間単価型、プロジェクト型に対応。

## 使用方法

### 情報確認

ユーザーに以下を確認：
- 見積先企業名
- 業務内容
- 金額（税抜）または複数明細
- 見積日（省略時は今日）
- 見積書番号（省略時は自動生成: QUO-YYYYMM-XXX）
- 有効期限（省略時は30日後）

### スクリプト実行

```bash
python scripts/create_quotation.py
```

### カスタマイズ

`scripts/create_quotation.py`の`QUOTATION_DATA`セクションを編集：

```python
QUOTATION_DATA = {
    # 発行者情報（自社情報）
    "issuer_name": "株式会社けんけん",
    "issuer_address": "〒760-0000 香川県高松市○○町1-2-3",
    "issuer_tel": "087-123-4567",
    "issuer_email": "info@kenken.co.jp",
    
    # 見積先・内容
    "client_name": "合同会社大吉",
    "description": "生成AIアドバイザリー業務",
    "amount": 200000,  # 税抜金額
    
    # 有効期限（日数）
    "validity_days": 30,
    
    # 備考
    "notes": [
        "お支払条件：月末締め翌月末払い",
        "契約期間：1年間（自動更新）",
        "恐れ入りますが、振込手数料はご負担ください。"
    ]
}
```

### 見積タイプ別の設定

#### 月額顧問型
```python
"description": "生成AIアドバイザリー業務",
"amount": 200000,
"notes": ["お支払条件：月末締め翌月末払い", "契約期間：1年間（自動更新）"]
```

#### 時間単価型
```python
"description": "生成AIコンサルティング業務（想定20時間/月）",
"amount": 200000,
"notes": ["稼働時間：実績に応じて精算いたします"]
```

#### プロジェクト型
```python
"description": "○○システム開発プロジェクト",
"amount": 2000000,
"notes": ["お支払条件：着手金30%、中間金40%、完了時30%", "作業期間：6ヶ月間"]
```

## 見積書の構成

1. タイトル「御見積書」
2. 見積書番号（QUO-YYYYMM-XXX）
3. 発行日
4. 見積先
5. 見積金額（税込、大きく強調）
6. 有効期限
7. 明細表
8. 小計・消費税(10%)・合計
9. 備考（支払条件、契約期間等）
10. 発行者情報

## 金額計算

- 消費税: 10%（端数切り捨て）
- 有効期限: 発行日から30日後（デフォルト）

## 出力ファイル

- `御見積書_QUO-YYYYMM-XXX.xlsx`

※ PDF送付が必要な場合は、Excelで開いて印刷メニューからPDF保存してください。

詳細は `references/quotation_format.md` を参照。

---

# 共通仕様

## デザイン（Jony Iveデザイン哲学）

請求書・見積書で完全に統一されたデザイン。

### 原則
1. **極限までシンプル** - 不要な装飾を排除
2. **余白を贅沢に** - 情報に呼吸する空間
3. **完璧な整列** - すべての要素を精密に配置
4. **控えめな色使い** - グレーとブラックのみ
5. **階層の明確化** - フォントサイズで重要度を表現

### 配色
- ブラック（#000000）: タイトル、重要な金額
- ダークグレー（#333333）: 本文テキスト
- ミディアムグレー（#666666）: セクション見出し
- ライトグレー（#999999）: 補足情報
- セパレーター（#E0E0E0）: 区切り線
- 背景: ホワイト（罫線なし）

### フォント（メイリオ統一）
- タイトル: 28pt Bold
- 金額（大）: 36pt Bold ← 最重要
- 合計金額: 14pt Bold
- 見出し: 11pt Bold
- 本文: 10pt
- 補足: 9pt

### レイアウト
- 余白: 左右に贅沢な余白
- 罫線: 最小限（細いグレーの下線のみ）
- グリッド線: 非表示
- 配置: 左揃え基調、金額は右揃え

## 技術仕様

- **ライブラリ**: openpyxl（Python）
- **フォント**: メイリオ
- **用紙サイズ**: A4
- **出力場所**: `/mnt/user-data/outputs/`

## 請求書と見積書の連携

```
見積書作成（QUO-202501-001）
  ↓ クライアント承認
契約締結
  ↓
請求書作成（INV-202501-001）
  ※同じデザイン、同じ金額
```

## Resources

### scripts/
- `create_invoice.py`: 請求書作成スクリプト
- `create_quotation.py`: 見積書作成スクリプト

### references/
- `invoice_format.md`: 請求書フォーマット詳細
- `quotation_format.md`: 見積書フォーマット詳細
