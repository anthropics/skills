# 請求書作成 - フォーマットリファレンス

## 標準的な請求書構成

### 必須項目
1. **タイトル**: 「請求書」
2. **請求書番号**: INV-YYYYMM-XXX形式（例: INV-202501-001）
3. **発行日**: 請求書の発行日
4. **請求先**: 会社名 御中
5. **請求金額**: 消費税込みの合計金額（大きく表示）
6. **明細表**:
   - 品名・業務内容
   - 数量
   - 単価（税抜）
   - 金額（税抜）
7. **小計**: 税抜合計
8. **消費税**: 10%
9. **合計**: 税込合計
10. **支払期限**: お支払期限の日付
11. **発行者情報**:
    - 会社名
    - 住所
    - 電話番号
    - メールアドレス
12. **振込先情報**:
    - 銀行名・支店名
    - 口座種別・口座番号
    - 口座名義
13. **備考**: 振込手数料負担等

### オプション項目
- インボイス登録番号（適格請求書発行事業者の場合）
- 会社ロゴ
- 請求先住所
- 担当者名
- プロジェクト名・案件名

## 請求タイプ別のフォーマット

### 1. 月額固定型（デフォルト）

**明細例:**
```
品名・業務内容: 生成AIアドバイザリー業務（2025年1月分）
数量: 1
単価: ¥200,000
金額: ¥200,000
```

**特徴:**
- シンプルで明快
- 毎月同じフォーマット
- 処理が簡単

### 2. 時間単価型

**明細例:**
```
品名・業務内容: 生成AIコンサルティング業務
数量: 20時間
単価: ¥10,000
金額: ¥200,000
```

**備考欄に追記:**
```
稼働時間内訳:
・戦略策定ミーティング: 8時間
・研修実施: 6時間
・資料作成: 6時間
```

### 3. プロジェクト型（分割払い）

**明細例（着手金の場合）:**
```
品名・業務内容: ○○プロジェクト 着手金（総額¥2,000,000の30%）
数量: 1
単価: ¥600,000
金額: ¥600,000
```

**明細例（中間金の場合）:**
```
品名・業務内容: ○○プロジェクト 中間金（総額¥2,000,000の40%）
数量: 1
単価: ¥800,000
金額: ¥800,000
```

### 4. 詳細明細型

**明細例:**
```
品名・業務内容                        数量   単価      金額
─────────────────────────────────────────────
生成AI活用戦略策定支援                2回   ¥50,000   ¥100,000
従業員向けAI研修実施                  1回   ¥80,000   ¥80,000
月次レポート作成                      1式   ¥20,000   ¥20,000
```

## 金額計算ルール

### 消費税の計算
```
消費税額 = 小計 × 0.10
（端数処理: 切り捨て）
```

### 源泉徴収税の計算（該当する場合）
```
源泉徴収税額 = 報酬額 × 10.21%
（100万円超の部分は20.42%）

お支払額 = 報酬額 + 消費税 - 源泉徴収税
```

**注意:** 法人間取引では通常、源泉徴収は不要。

## 支払期限の設定パターン

### パターン1: 請求月末（デフォルト）
```
請求日: 2025年1月15日
支払期限: 2025年1月31日
```

### パターン2: 翌月末
```
請求日: 2025年1月15日
支払期限: 2025年2月28日
```

### パターン3: 請求日から30日後
```
請求日: 2025年1月15日
支払期限: 2025年2月14日
```

## 請求書番号の採番ルール

### 形式: INV-YYYYMM-XXX

**例:**
```
INV-202501-001  # 2025年1月の1件目
INV-202501-002  # 2025年1月の2件目
INV-202502-001  # 2025年2月の1件目
```

**連番管理:**
- 月ごとにリセット
- 3桁のゼロパディング
- 年月を含めることで一意性を確保

## デザインガイドライン（Jony Iveデザイン哲学）

### デザイン原則

**"Simplicity is the ultimate sophistication"** - Leonardo da Vinci

ジョナサン・アイブが追求した、極限までシンプルで美しいデザインを請求書に適用：

1. **極限までシンプルに** - 不要な装飾を徹底的に排除
2. **余白を贅沢に使う** - 情報に呼吸する空間を与える
3. **完璧な整列** - すべての要素を精密に配置
4. **控えめな色使い** - グレーとブラックのみ
5. **階層の明確化** - フォントサイズで情報の重要度を表現
6. **機能美** - すべての要素に意味がある

### 色使い

**モノトーンの美学:**
- **ブラック（#000000）**: タイトル、請求金額、合計金額
- **ダークグレー（#333333）**: 本文テキスト
- **ミディアムグレー（#666666）**: セクション見出し
- **ライトグレー（#999999）**: 補足情報、日付、番号
- **ペールグレー（#E0E0E0）**: セパレーターライン
- **ホワイト（#FFFFFF）**: 背景（装飾なし）

**禁則:**
- ✗ ブルー、赤などの装飾的な色は使わない
- ✗ グラデーション、影効果は使わない
- ✗ 背景色（ごく微妙なグレー以外）は使わない

### フォント

**すべてメイリオで統一:**
- **タイトル「請求書」**: 28pt、太字、ブラック
- **請求金額（大）**: 36pt、太字、ブラック ← 最も目立たせる
- **合計金額**: 14pt、太字、ブラック
- **セクション見出し**: 11pt、太字、#666666
- **本文**: 10pt、#333333
- **補足情報**: 9pt、#999999

**タイポグラフィの原則:**
- フォントは1種類のみ（メイリオ）
- サイズで階層を表現（6段階）
- 太字は重要な要素のみ
- イタリック体は使わない

### レイアウト

**余白の美学:**
- 左右に贅沢な余白（列A、列Fは余白専用）
- 行間も広く取る（重要な要素の前後は特に）
- 情報をぎゅうぎゅうに詰めない

**罫線の使用:**
- 罫線は最小限のみ
- 細いグレーの下線（#E0E0E0）のみ使用
- 四方を囲む枠線は使わない
- セパレーターとして機能する場合のみ

**配置:**
- タイトル: 左揃え（中央揃えは避ける）
- 請求金額: 左揃え、大きく、目立たせる
- 金額列: 右揃え、完璧に整列
- すべての要素を縦のグリッドに揃える

**グリッド線:**
- Excelのグリッド線は非表示
- 白い背景に黒とグレーのみ
- 罫線で囲まれた「表」のような見た目は避ける

**行の高さの最適化:**
- 請求金額行(36pt): 54pt（フォントサイズ×1.5で見切れ防止）
- タイトル行(28pt): 35pt
- 一般行: 18-22pt
- ※大きなフォントサイズを使用する場合、行の高さは「フォントサイズ×1.5」を推奨

### 情報階層

**視覚的な重要度:**
1. **最重要**: 請求金額（36pt、最大）
2. **重要**: タイトル「請求書」（28pt）、合計金額（14pt）
3. **通常**: 明細内容、振込先（10pt）
4. **補足**: 請求書番号、日付、発行者情報（9pt）

**空間の使い方:**
- 重要な要素の前後には広い余白
- 関連する情報はグループ化
- セクション間には明確な区切り

## インボイス制度対応（適格請求書）

### 必須項目（インボイス登録事業者の場合）
1. 適格請求書発行事業者の登録番号
2. 税率ごとに区分した消費税額
3. 税率（10%または8%）の明記

**表示例:**
```
適格請求書発行事業者登録番号: T1234567890123
```

**税額表示例:**
```
小計（税抜）                      ¥200,000
消費税（10%）                     ¥20,000
──────────────────────────────
合計                              ¥220,000
```

### 免税事業者の場合
登録番号の記載は不要。通常の請求書として発行。

## カスタマイズ例

### 会社ロゴの追加
Excelの左上（A1:B3）にロゴ画像を挿入：
```python
from openpyxl.drawing.image import Image
img = Image('/path/to/logo.png')
img.height = 50
img.width = 150
ws.add_image(img, 'A1')
```

### 複数明細行
```python
items = [
    {"description": "戦略策定", "qty": 2, "price": 50000},
    {"description": "研修実施", "qty": 1, "price": 80000},
    {"description": "レポート", "qty": 1, "price": 20000}
]

for item in items:
    row += 1
    ws.cell(row=row, column=2).value = item["description"]
    ws.cell(row=row, column=3).value = item["qty"]
    ws.cell(row=row, column=4).value = item["price"]
    ws.cell(row=row, column=5).value = item["qty"] * item["price"]
```

### 備考欄の拡張
```python
notes = [
    "振込手数料はご負担ください。",
    "入金確認後、領収書を発行いたします。",
    "ご不明な点がございましたら、お気軽にお問い合わせください。"
]

for note in notes:
    row += 1
    ws.cell(row=row, column=2).value = note
```

## よくある質問

### Q1: 請求書番号はどう管理すべき？
A: 別途Excelやデータベースで連番を管理するか、発行日時から自動生成する。

### Q2: 消費税の端数処理は？
A: 一般的に切り捨て。ただし、契約書で明記されている場合はそれに従う。

### Q3: 再発行時の番号は？
A: 同じ番号で「再発行」と明記するか、新しい番号で発行し「○○の再発行」と記載。

### Q4: 電子インボイスは？
A: Excel形式で発行し、必要に応じてPDFに変換してメールで送付。電子帳簿保存法に準拠して保存。

### Q5: 金額が見切れる場合は？
A: 行の高さ不足が原因。36ptフォントの場合、行の高さを54pt（フォントサイズ×1.5）に設定。
列幅は76ptあれば¥33,000,000まで表示可能。

## トラブルシューティング

### 金額表示が見切れる問題

**症状**: 請求金額（36pt太字）の上下が切れて表示される

**原因**: 行の高さ不足
- 不適切: 45pt → 文字の上下が25%切れる可能性
- 適切: 54pt（36pt × 1.5）

**解決方法**:
```python
ws.row_dimensions[10].height = 54  # 45 → 54 に変更
```

**検証方法**:
```python
# 推奨行の高さ = フォントサイズ × 1.5
font_size = 36
recommended_height = font_size * 1.5  # = 54
```
