# 見積書作成 - フォーマットリファレンス

## 標準的な見積書構成

### 必須項目
1. **タイトル**: 「御見積書」
2. **見積書番号**: QUO-YYYYMM-XXX形式（例: QUO-202501-001）
3. **発行日**: 見積書の発行日
4. **見積先**: 会社名
5. **見積金額**: 消費税込みの合計金額（大きく表示）
6. **有効期限**: お見積有効期限の日付
7. **明細表**:
   - 業務内容・品名
   - 数量（複数項目の場合）
   - 単価（複数項目の場合）
   - 金額（税抜）
8. **小計**: 税抜合計
9. **消費税**: 10%
10. **合計**: 税込合計
11. **備考**: 支払条件、契約期間、その他注意事項
12. **発行者情報**:
    - 会社名
    - 住所
    - 電話番号
    - メールアドレス

### 請求書との違い
- タイトルが「御見積書」
- 番号が QUO-（Quotation）で始まる
- 有効期限を表示（通常30日後）
- 振込先情報は不要（見積段階では不要）
- 備考欄に支払条件、契約期間などを記載

## 見積タイプ別のフォーマット

### 1. 月額顧問型（デフォルト）

**明細例:**
```
業務内容: 生成AIアドバイザリー業務
金額: ¥200,000
```

**備考例:**
```
お支払条件：月末締め翌月末払い
契約期間：1年間（自動更新）
恐れ入りますが、振込手数料はご負担ください。
```

### 2. 時間単価型

**明細例:**
```
業務内容: 生成AIコンサルティング業務
数量: 想定20時間/月
単価: ¥10,000
金額: ¥200,000
```

**備考例:**
```
お支払条件：月末締め翌月末払い
稼働時間：実績に応じて精算
契約期間：1年間（自動更新）
```

### 3. プロジェクト型

**明細例:**
```
業務内容: ○○システム開発プロジェクト
金額: ¥2,000,000
```

**備考例:**
```
お支払条件：着手金30%、中間金40%、完了時30%
作業期間：契約締結日より6ヶ月間
成果物：設計書、ソースコード、マニュアル
```

### 4. 複数明細型（詳細見積）

**明細例:**
```
業務内容                        数量   単価      金額
─────────────────────────────────────────────
戦略策定支援                    2回   ¥50,000   ¥100,000
従業員向けAI研修                1回   ¥80,000   ¥80,000
月次レポート作成                1式   ¥20,000   ¥20,000
```

### 5. 複数プラン提示型

**プランA（ライト）:**
```
業務内容: 月1回の定例相談
金額: ¥100,000/月
```

**プランB（スタンダード）:**
```
業務内容: 月2回の定例相談 + レポート
金額: ¥200,000/月
```

**プランC（プレミアム）:**
```
業務内容: 週1回の定例相談 + レポート + 研修
金額: ¥500,000/月
```

## 金額計算ルール

### 消費税の計算
```
消費税額 = 小計 × 0.10
（端数処理: 切り捨て）
```

## 有効期限の設定パターン

### パターン1: 発行日から30日後（デフォルト）
```
発行日: 2025年1月15日
有効期限: 2025年2月14日
```

### パターン2: 発行月末
```
発行日: 2025年1月15日
有効期限: 2025年1月31日
```

### パターン3: 発行日から60日後
```
発行日: 2025年1月15日
有効期限: 2025年3月16日
```

## 見積書番号の採番ルール

### 形式: QUO-YYYYMM-XXX

**例:**
```
QUO-202501-001  # 2025年1月の1件目
QUO-202501-002  # 2025年1月の2件目
QUO-202502-001  # 2025年2月の1件目
```

**連番管理:**
- 月ごとにリセット
- 3桁のゼロパディング
- 年月を含めることで一意性を確保

## デザインガイドライン（Jony Iveデザイン哲学）

### デザイン原則

**請求書と完全に統一:**
- 極限までシンプルに
- 余白を贅沢に使う
- 完璧な整列
- 控えめな色使い（モノトーンのみ）
- 階層の明確化

### 色使い

**モノトーンの美学:**
- **ブラック（#000000）**: タイトル、見積金額、合計金額
- **ダークグレー（#333333）**: 本文テキスト
- **ミディアムグレー（#666666）**: セクション見出し
- **ライトグレー（#999999）**: 補足情報、日付、番号
- **ペールグレー（#E0E0E0）**: セパレーターライン

### フォント（すべてメイリオ）
- **タイトル「御見積書」**: 28pt、太字、ブラック
- **見積金額（大）**: 36pt、太字、ブラック ← 最も目立たせる
- **合計金額**: 14pt、太字、ブラック
- **セクション見出し**: 11pt、太字、#666666
- **本文**: 10pt、#333333
- **補足情報**: 9pt、#999999

### レイアウト
- 罫線は最小限（セパレーターのみ）
- グリッド線非表示
- 左揃えが基本、金額のみ右揃え
- 余白を贅沢に使う
- **行の高さの最適化**:
  - 見積金額行(36pt): 54pt（フォントサイズ×1.5で見切れ防止）
  - タイトル行(28pt): 35pt
  - 一般行: 18-22pt
  - ※大きなフォントサイズを使用する場合、行の高さは「フォントサイズ×1.5」を推奨

## 備考欄のカスタマイズ

### 月額顧問型の備考例
```python
"notes": [
    "お支払条件：月末締め翌月末払い",
    "契約期間：1年間（自動更新）",
    "恐れ入りますが、振込手数料はご負担ください。"
]
```

### プロジェクト型の備考例
```python
"notes": [
    "お支払条件：着手金30%、中間金40%、完了時30%",
    "作業期間：契約締結日より6ヶ月間",
    "成果物：設計書、ソースコード、操作マニュアル",
    "恐れ入りますが、振込手数料はご負担ください。"
]
```

### 時間単価型の備考例
```python
"notes": [
    "お支払条件：月末締め翌月末払い",
    "稼働時間：実績に応じて精算いたします",
    "契約期間：1年間（自動更新）",
    "最低稼働時間：月10時間"
]
```

## 複数明細の作成例

### 詳細見積（複数項目）
```python
items = [
    {"description": "生成AI活用戦略策定支援", "qty": 1, "price": 100000},
    {"description": "従業員向けAI研修実施", "qty": 2, "price": 80000},
    {"description": "月次レポート作成", "qty": 1, "price": 20000}
]

create_quotation(
    client_name="株式会社サンプル",
    items=items,
    quotation_date=datetime(2025, 1, 15)
)
```

### 月額顧問（シンプル）
```python
create_quotation(
    client_name="合同会社大吉",
    description="生成AIアドバイザリー業務",
    amount=200000,
    quotation_date=datetime(2025, 1, 15)
)
```

## 複数プラン提示の作成方法

### 方法1: 3枚の見積書を作成
```python
# プランA
create_quotation(
    client_name="株式会社サンプル",
    description="生成AIアドバイザリー業務（ライトプラン）",
    amount=100000,
    quotation_number="QUO-202501-001A"
)

# プランB
create_quotation(
    client_name="株式会社サンプル",
    description="生成AIアドバイザリー業務（スタンダードプラン）",
    amount=200000,
    quotation_number="QUO-202501-001B"
)

# プランC
create_quotation(
    client_name="株式会社サンプル",
    description="生成AIアドバイザリー業務（プレミアムプラン）",
    amount=500000,
    quotation_number="QUO-202501-001C"
)
```

### 方法2: 1枚の見積書に複数プランを記載
```python
items = [
    {"description": "プランA：月1回相談", "qty": 1, "price": 100000},
    {"description": "プランB：月2回相談 + レポート", "qty": 1, "price": 200000},
    {"description": "プランC：週1回相談 + レポート + 研修", "qty": 1, "price": 500000}
]
```

## よくある質問

### Q1: 見積書番号はどう管理すべき？
A: 月ごとに連番をリセット。別途Excelやデータベースで管理するか、発行日時から自動生成。

### Q2: 有効期限は何日が適切？
A: 一般的に30日。プロジェクトの規模や調整期間に応じて調整。

### Q3: 見積書と請求書の番号は連動する？
A: 連動しない。見積書はQUO-、請求書はINV-で別管理。

### Q4: 再見積時の番号は？
A: 新しい番号で発行し、備考欄に「○○の再見積」と記載。

### Q5: 見積書に印鑑は必要？
A: 法的には不要。ただし、クライアントの要望に応じて押印することも。

### Q6: 金額が見切れる場合は？
A: 行の高さ不足が原因。36ptフォントの場合、行の高さを54pt（フォントサイズ×1.5）に設定。
列幅は76ptあれば¥33,000,000まで表示可能。

## トラブルシューティング

### 金額表示が見切れる問題

**症状**: 見積金額（36pt太字）の上下が切れて表示される

**原因**: 行の高さ不足
- 不適切: 45pt → 文字の上下が25%切れる可能性
- 適切: 54pt（36pt × 1.5）

**解決方法**:
```python
ws.row_dimensions[10].height = 54  # 45 → 54 に変更
```

**検証方法**:
```python
# 推奨行の高さ = フォントサイズ × 1.5
font_size = 36
recommended_height = font_size * 1.5  # = 54
```

## 見積書から請求書への流れ

```
見積書作成（QUO-202501-001）
  ↓
クライアント承認
  ↓
契約締結
  ↓
業務開始
  ↓
請求書作成（INV-202501-001）
  ※見積書の金額と一致させる
```

見積書と請求書は同じJony Iveデザインで統一されているため、一貫したブランドイメージを提供できます。
