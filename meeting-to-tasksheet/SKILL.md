---
name: meeting-to-tasksheet
description: 会議の音声入力・テキストから議事録とタスク管理表を自動生成（動的関数版）。ガントチャート・進捗サマリーは全てExcel関数で実装し、タスク一覧のステータス変更で自動再計算。6シート構成で議事録、タスク一覧（ドロップダウン選択・条件付き書式）、ガントチャート（ステータス連動色・今週ハイライト）、進捗サマリー（COUNTIF/SUMPRODUCT関数）、リスク・課題トラッキング、Slack/Teams投稿用サマリーを含む。会議シリーズ対応（前回の宿題表示）。フォントはメイリオ統一。「会議をまとめて」「議事録を作って」「タスク管理表を生成」などのリクエストで使用。
---

# Meeting to Tasksheet（動的関数版 v2）

会議の音声入力・テキストから、プロフェッショナルな議事録とタスク管理Excelを自動生成する。

## 🆕 v2.0 動的関数版の特徴

ガントチャート・進捗サマリーは全てExcel関数（COUNTIF/COUNTIFS/SUMIF/SUMPRODUCT/TODAY）で実装。
**タスク一覧のステータスを変更するだけで、全シートが自動的に再計算されます。**

### ハードコードではなくExcel関数を使用

| 項目 | 従来版 | 動的関数版 v2 |
|------|--------|--------------|
| 進捗サマリー集計 | Pythonで計算した値をセルに入力 | COUNTIF/SUMPRODUCT関数で動的計算 |
| ガントチャート色 | Python側で色を直接指定 | 条件付き書式でステータス連動 |
| 期限状況 | 生成時点の値 | TODAY()関数で常に最新 |
| 完了率 | 固定値 | タスク一覧の変更で自動更新 |
| 残日数 | 手計算 | =IF(H="完了","-",F-TODAY()) |

## 概要

会議内容を多角的に整理し、6シート構成の高機能Excelを生成:

1. **議事録** - 基本情報、議論サマリー、決定事項、前回の宿題
2. **タスク一覧** - ドロップダウン選択、残日数自動計算、条件付き書式
3. **ガントチャート** - ステータス連動色、今週ハイライト、タスク一覧参照
4. **進捗サマリー** - 完了率、ステータス別・優先度別・担当者別集計（全て動的）
5. **リスク・課題** - レベル別集計、高リスク自動ハイライト
6. **Slack投稿用** - マークダウン/プレーンテキスト形式のサマリー

## 使用Excel関数一覧

```excel
# ステータス別カウント
=COUNTIF(タスク一覧!H5:H14,"完了")

# 完了率計算（TEXT関数で%表示）
=TEXT(COUNTIF(タスク一覧!H5:H14,"完了")/10,"0%")

# 担当者別工数合計
=SUMIF(タスク一覧!D5:D14,A24,タスク一覧!J5:J14)

# 優先度かつ完了のカウント（複数条件）
=COUNTIFS(タスク一覧!I5:I14,"高",タスク一覧!H5:H14,"完了")

# 期限超過タスク数（未完了のみ）- 配列計算
=SUMPRODUCT((タスク一覧!F5:F14<TODAY())*(タスク一覧!H5:H14<>"完了"))

# 今週期限タスク数
=SUMPRODUCT((タスク一覧!F5:F14>=TODAY())*(タスク一覧!F5:F14<=TODAY()+7)*(タスク一覧!H5:H14<>"完了"))

# 残日数計算（完了の場合は"-"表示）
=IF(H5="完了","-",F5-TODAY())

# ガントバー表示（期間内なら■）
=IF(AND(週開始日>=開始日,週開始日<=期限+6),"■","")
```

## 入力要件

### 会議情報（meeting_info）
```json
{
  "title": "会議名",
  "datetime": "2025年1月15日 14:00-15:30",
  "location": "場所",
  "attendees": "参加者（カンマ区切り）",
  "recorder": "記録者",
  "meeting_no": 1
}
```

### タスク情報（tasks）
```json
{
  "name": "タスク名",
  "assignee": "担当者",
  "start_date": "2025-01-15",
  "due_date": "2025-01-20",
  "status": "未着手|進行中|完了|保留",
  "priority": "高|中|低",
  "estimated_hours": 4,
  "depends_on": "1,2",
  "is_milestone": false,
  "notes": "備考"
}
```

### リスク情報（risks）
```json
{
  "type": "リスク|課題",
  "content": "内容",
  "level": "高|中|低",
  "impact": "影響",
  "countermeasure": "対策",
  "assignee": "担当",
  "due_date": "期限",
  "status": "未対応|対応中|解決済|保留"
}
```

### 前回の宿題（prev_action_items）
```json
{
  "content": "宿題内容",
  "assignee": "担当者",
  "status": "完了|未完了"
}
```

## 日付の自動推定

会議内容から実際の日付を推定し、現実的なスケジュールを生成する。

| 表現 | 変換ルール | 例（会議日: 2025-01-15） |
|------|-----------|------------------------|
| 今日、本日 | 会議開催日 | 2025-01-15 |
| 今週中 | 会議週の金曜日 | 2025-01-17 |
| 来週 | 翌週の金曜日 | 2025-01-24 |
| 月末 | 当月の最終日 | 2025-01-31 |
| 来月 | 翌月末 | 2025-02-28 |
| 年度内、年度末 | 3月31日 | 2025-03-31 |
| 新年度、4月から | 4月1日 | 2025-04-01 |
| X月 | X月末日 | 2025-11-30 |
| Xヶ月後 | 会議日+Xヶ月 | 2025-04-15 |

### ステータスの選択肢
- **未着手**: デフォルト
- **進行中**: 作業開始済み
- **完了**: 完了済み
- **保留**: 一時停止中

### 優先度の選択肢と自動判定
- **高** 🔴: 緊急・重要（1週間～2ヶ月）
- **中** 🟡: 通常（1～6ヶ月）
- **低** 🟢: 余裕あり（3ヶ月～1年）

### マイルストーンの自動判定
以下に該当するタスクは◆マイルストーンとして強調:
- 「大きな節目」と明示的に言及
- 複数のタスクが依存
- 組織全体に影響
- 大規模タスク（20時間以上）

## 出力Excel構成（6シート）

### シート1: 議事録
```
┌─────────────────────────────────────────────────────┐
│  📋 会議議事録                           第1回      │
├─────────────────────────────────────────────────────┤
│ ■ 会議基本情報                                      │
│ ┌──────┬────────────────────────────────────┐      │
│ │会議名│プロジェクト定例会議                │      │
│ │日時  │2025年1月15日 14:00-15:30          │      │
│ │場所  │会議室A                            │      │
│ │参加者│田中、佐藤、鈴木                   │      │
│ │記録者│Claude                             │      │
│ └──────┴────────────────────────────────────┘      │
│                                                     │
│ ■ 前回からの宿題                                    │
│ ┌───┬──────────────────┬────┬──────┐              │
│ │No.│内容              │担当│状況  │              │
│ ├───┼──────────────────┼────┼──────┤              │
│ │ 1 │要件定義書の確認  │佐藤│✅完了│              │
│ └───┴──────────────────┴────┴──────┘              │
│                                                     │
│ ■ 議論内容サマリー                                  │
│ [会議の要約テキスト]                                │
│                                                     │
│ ■ 決定事項                                          │
│ ┌───┬──────────────────────────────────────┐      │
│ │No.│内容                                │      │
│ ├───┼──────────────────────────────────────┤      │
│ │ 1 │✓ リリース日: 2025年2月20日         │      │
│ │ 2 │✓ テスト期間: 2週間確保             │      │
│ └───┴──────────────────────────────────────┘      │
│                                                     │
│ ■ 次回会議                                          │
│ 日時: 2025年2月5日 14:00                            │
│ 議題: 進捗確認                                      │
└─────────────────────────────────────────────────────┘
```

### シート2: タスク一覧
```
┌───┬────────────────┬──────┬────────┬────────┬────┬──────┬────┬────┬────┬──────┐
│No.│ タスク名        │担当者│ 開始日 │ 期限   │残日│ステータス│優先度│工数│依存│ 備考 │
├───┼────────────────┼──────┼────────┼────────┼────┼──────────┼──────┼────┼────┼──────┤
│ 1 │会場予約確定     │MIRAI │01/15   │01/20   │ -8 │進行中    │高    │  1 │    │      │
│ 2 │◆リハーサル     │全員  │02/15   │02/15   │ 48 │未着手    │高    │  3 │←5,6│      │
└───┴────────────────┴──────┴────────┴────────┴────┴──────────┴──────┴────┴────┴──────┘
```

**動的機能**:
- **ステータス・優先度**: ドロップダウン選択（リスト入力規則）
- **残日数**: `=IF(H行="完了","-",F行-TODAY())` で動的計算
- **条件付き書式**:
  - `$H行="完了"` → 行全体が緑背景 (#C8E6C9)
  - `$H行="保留"` → 行全体がオレンジ背景 (#FFE0B2)
  - `AND($F行<TODAY(),$H行<>"完了")` → 期限セル赤背景 (#FFCDD2)

### シート3: ガントチャート
```
┌───┬────────────────┬─────┬────┬────┬────┬─────┬─────┬─────┬─────┐
│No.│ タスク名        │担当 │開始│期限│状態│11/24│12/01│12/08│12/15│
├───┼────────────────┼─────┼────┼────┼────┼─────┼─────┼─────┼─────┤
│ 1 │タスクA         │Ken  │11/25│12/06│未着手│     │ ■  │ ■  │     │
│ 2 │タスクB         │MIRAI│12/07│12/20│進行中│     │     │ ■  │ ■  │
└───┴────────────────┴─────┴────┴────┴────┴─────┴─────┴─────┴─────┘
```

**動的機能**:
- **基準日**: `=DATE(2025,11,1)` で変更可能
- **週ヘッダー**: `=$C$2+{week*7}` で動的に日付計算
- **タスク情報**: `=タスク一覧!A行` でタスク一覧シートを参照
- **バー表示**: `=IF(AND(週開始日>=開始日,週開始日<=期限+6),"■","")` で動的判定
- **条件付き書式でステータス連動色**:
  - `AND($G行="未着手",セル="■")` → グレー (#BDBDBD)
  - `AND($G行="進行中",セル="■")` → 青 (#4472C4)
  - `AND($G行="完了",セル="■")` → 緑 (#7CB342)
  - `AND($G行="保留",セル="■")` → オレンジ (#FFA726)
- **今週ハイライト**: `AND(週開始<=TODAY(),週開始+6>=TODAY())` → 赤背景

### シート4: 進捗サマリー（完全動的）
```
┌─────────────────────────────────────────┐
│          📊 進捗サマリー                 │
├─────────────────────────────────────────┤
│                                         │
│           0%           完了率           │
│                        完了: 0 / 全10タスク │
│                        総工数: 136h      │
│                                         │
├─────────────────────────────────────────┤
│ ■ ステータス別集計                       │
│ ┌──────────┬────┬────┐                  │
│ │ステータス │件数│割合│                  │
│ ├──────────┼────┼────┤                  │
│ │未着手    │ 9  │90% │ ← =COUNTIF(...)  │
│ │進行中    │ 1  │10% │                  │
│ │完了      │ 0  │ 0% │                  │
│ │保留      │ 0  │ 0% │                  │
│ └──────────┴────┴────┘                  │
├─────────────────────────────────────────┤
│ ■ 優先度別集計                           │
│ ┌────┬────┬────┬────┐                   │
│ │優先│件数│完了│完了率│                  │
│ ├────┼────┼────┼────┤                   │
│ │高  │ 4  │ 0  │ 0% │ ← =COUNTIFS(...) │
│ │中  │ 4  │ 0  │ 0% │                   │
│ │低  │ 2  │ 0  │ 0% │                   │
│ └────┴────┴────┴────┘                   │
├─────────────────────────────────────────┤
│ ■ 担当者別タスク数・工数                 │
│ ┌──────┬────┬────┬────┬────┐            │
│ │担当  │件数│工数│完了│完了率│           │
│ ├──────┼────┼────┼────┼────┤            │
│ │Ken   │ 3  │ 24h│ 0  │ 0% │← =SUMIF   │
│ │MIRAI │ 3  │ 12h│ 0  │ 0% │            │
│ └──────┴────┴────┴────┴────┘            │
├─────────────────────────────────────────┤
│ ■ 期限状況                               │
│ 🚨 期限超過: 2件 ← =SUMPRODUCT+TODAY()  │
│ ⚠️ 今週期限: 1件                         │
│ 📅 来週以降: 7件                         │
└─────────────────────────────────────────┘
```

**使用関数詳細**:
```excel
# 完了率（大きく表示）
=TEXT(COUNTIF(タスク一覧!H5:H14,"完了")/10,"0%")

# ステータス別件数
=COUNTIF(タスク一覧!H5:H14,"未着手")

# ステータス別割合
=IF(10>0,B9/10,0)

# 優先度別完了数（複数条件）
=COUNTIFS(タスク一覧!I5:I14,"高",タスク一覧!H5:H14,"完了")

# 担当者別タスク数
=COUNTIF(タスク一覧!D5:D14,A24)

# 担当者別工数合計
=SUMIF(タスク一覧!D5:D14,A24,タスク一覧!J5:J14)

# 期限超過（配列計算）
=SUMPRODUCT((タスク一覧!F5:F14<TODAY())*(タスク一覧!H5:H14<>"完了"))

# 今週期限
=SUMPRODUCT((タスク一覧!F5:F14>=TODAY())*(タスク一覧!F5:F14<=TODAY()+7)*(タスク一覧!H5:H14<>"完了"))

# 来週以降
=SUMPRODUCT((タスク一覧!F5:F14>TODAY()+7)*(タスク一覧!H5:H14<>"完了"))
```

### シート5: リスク・課題トラッキング
```
┌───┬────┬─────────────────┬────┬────────┬──────────┬────┬──────┬──────┐
│No.│種別│ 内容            │レベル│ 影響   │ 対策     │担当│ 期限 │状態  │
├───┼────┼─────────────────┼────┼────────┼──────────┼────┼──────┼──────┤
│ 1 │リス│ネットワーク不安定│高  │デモ失敗│モバイル準備│Ken│02/10 │対応中│
│ 2 │課題│システム連携なし │高  │二重入力│API調査   │本田│01/31 │未対応│
└───┴────┴─────────────────┴────┴────────┴──────────┴────┴──────┴──────┘
```

**動的機能**:
- **レベル・状態**: ドロップダウン選択
- **条件付き書式**: `$E行="高"` → 行全体が赤背景
- **集計**: COUNTIF関数で動的カウント

### シート6: Slack投稿用サマリー

**動的進捗表示**:
```
■ 現在の進捗状況（自動更新）
完了率:     10%      ← =COUNTIF(...)/total
完了タスク: 1/10件   ← =COUNTIF(...)&"/"&total&"件"
期限超過:   2件      ← =SUMPRODUCT(...)&"件"
今週期限:   1件
```

**マークダウン形式**:
```markdown
# 📋 会議名 議事録
**日時**: 2025年1月15日
**参加者**: MIRAIさん、ダイチさん、Ken

## ✅ 決定事項
1. 開催日: 2025年2月20日
2. 会場: 商工会議所

## 📝 タスク一覧
| タスク | 担当 | 期限 | 優先度 |
|--------|------|------|--------|
| 会場予約 | MIRAI | 01/20 | 高 |
| 告知チラシ | MIRAI | 01/25 | 中 |

## ⚠️ 主要リスク
- [高] ネットワーク環境が不安定
- [中] 参加者が集まらない
```

**プレーンテキスト形式**:
```
【会議名 議事録】
日時: 2025年1月15日
参加者: MIRAIさん、ダイチさん、Ken

▼ 決定事項
  1. 開催日: 2025年2月20日
  2. 会場: 商工会議所

▼ タスク一覧
  ・会場予約 / MIRAI / 01/20
  ・告知チラシ / MIRAI / 01/25
```

## 技術仕様

### フォント
**メイリオ**で統一

### カラーパレット
```python
COLORS = {
    'primary': '2E5090',      # ダークブルー（ヘッダー、タイトル）
    'secondary': '4A90E2',    # ライトブルー（サブヘッダー）
    'accent': '7CB342',       # グリーン（完了バー）
    'warning': 'FFA726',      # オレンジ（保留バー）
    'danger': 'EF5350',       # レッド（高リスク）
    'green_bg': 'C8E6C9',     # 完了タスク背景
    'orange_bg': 'FFE0B2',    # 保留タスク背景
    'red_bg': 'FFCDD2',       # 期限超過・高リスク背景
    'blue_bar': '4472C4',     # 進行中バー
    'gray_bar': 'BDBDBD',     # 未着手バー
    'light_gray': 'F5F5F5',   # 背景
}
```

### 条件付き書式一覧

**タスク一覧シート**:
| 条件 | 範囲 | 効果 |
|------|------|------|
| `$H行="完了"` | B行:L行 | 緑背景 |
| `$H行="保留"` | B行:L行 | オレンジ背景 |
| `AND($F行<TODAY(),$H行<>"完了")` | F行 | 赤背景 |
| `AND(ISNUMBER($G行),$G行<0)` | G行 | 赤背景 |

**ガントチャートシート**:
| 条件 | 範囲 | 効果 |
|------|------|------|
| `AND($G行="完了",セル="■")` | ガントエリア | 緑背景 |
| `AND($G行="進行中",セル="■")` | ガントエリア | 青背景 |
| `AND($G行="保留",セル="■")` | ガントエリア | オレンジ背景 |
| `AND($G行="未着手",セル="■")` | ガントエリア | グレー背景 |
| `AND(週開始<=TODAY(),週開始+6>=TODAY())` | 列全体 | 赤背景（今週） |

**リスク・課題シート**:
| 条件 | 範囲 | 効果 |
|------|------|------|
| `$E行="高"` | B行:J行 | 赤背景 |

## 使用方法

### Pythonスクリプト

```bash
# デモモード（サンプルデータで生成）
python scripts/generate_meeting_tasksheet_rich.py --demo --output demo.xlsx

# JSONファイルから生成
python scripts/generate_meeting_tasksheet_rich.py --json meeting_data.json --output result.xlsx
```

### Claudeで使用

```
この会議の文字起こしから議事録とタスク管理表を作成して

[会議の文字起こしテキストを貼り付け]
```

### 数式再計算（LibreOfficeがある場合）
```bash
python /mnt/skills/public/xlsx/recalc.py output.xlsx 60
```

## 制約

### DO（必須）
- 集計値はExcel関数で実装（ハードコード禁止）
- ドロップダウンでユーザー編集可能
- 条件付き書式で視覚的フィードバック
- フォントはメイリオ統一
- 会議内容から実際の日付を推定・抽出
- タスク一覧の変更が他シートに自動反映される設計
- 日付はDATE()関数で入力

### DO NOT（禁止）
- Python側でハードコード集計
- 架空の日付を設定
- 日本語環境で表示できない特殊文字
- 編集不可な静的シート
- 絵文字を大量に使用（ドロップダウンで選択しづらくなる）

## 動的関数チェックリスト

議事録とタスク管理表を生成する際、以下を確認:

- [ ] 進捗サマリーの完了率はCOUNTIF関数で計算
- [ ] ステータス別集計はCOUNTIF関数で計算
- [ ] 優先度×ステータスはCOUNTIFS関数で計算
- [ ] 担当者別工数はSUMIF関数で計算
- [ ] 期限状況はSUMPRODUCT+TODAY()で計算
- [ ] ガントチャートのバーはIF+AND関数で動的判定
- [ ] ガントチャートの色は条件付き書式で制御
- [ ] タスク一覧の残日数は`=IF(H="完了","-",F-TODAY())`で計算
- [ ] 今週のハイライトはTODAY()関数で動的判定
- [ ] タスク一覧でステータスを変更すると全シートが自動更新される

## バージョン履歴

- **v2.0** (2025-11): 動的関数版リリース
  - 進捗サマリーを完全Excel関数化
  - ガントチャートを条件付き書式で動的色変更
  - 残日数の動的計算
  - 期限状況のTODAY()関数対応
- **v1.5** (2025-01): 日付自動推定機能を追加
- **v1.0** (2024): 初版リリース

## 関連スキル

- **sales-analyzer-xlsx**: 売上データ分析
- **shift-scheduler**: シフト表自動生成
- **xlsx**: Excelファイル作成・編集の基本スキル
