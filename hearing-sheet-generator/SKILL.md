---
name: hearing-sheet-generator
description: 初回商談・現状把握ヒアリング用のExcelシートを動的に生成。業種（製造/小売/福祉/金融など14種）と対象部門（経理/人事/営業/現場など）を指定すると、業種特有の課題・業務フロー・使用システムの質問項目を自動追加。基本情報、IT環境、部門別ヒアリング、優先度整理の複数シート構成。「ヒアリングシートを作成」「現状把握シートを生成」「商談準備シートを作って」等のリクエストで使用。【自動記入機能】文字起こしテキストから内容を解析し、シートに自動記入。確信度に応じてセル色分け、低確信項目はコメントで補足。
---

# Hearing Sheet Generator（ヒアリングシート生成）

## Overview

初回商談・現状把握ヒアリング用のExcelシートを自動生成するスキル。業種と対象部門を指定すると、その組み合わせに応じた質問項目を動的に生成する。

**特徴**:
- 業種別の「よくある課題」「典型的な業務フロー」を自動追加
- 部門別の専門質問セクションを動的生成
- 集計・分析しやすいExcel形式
- Jony Iveデザイン哲学に基づくシンプルなレイアウト

## 入力パラメータ

ユーザーから以下を収集する（不足時は確認）:

| パラメータ | 必須 | 説明 | 例 |
|-----------|------|------|-----|
| company_name | ○ | ヒアリング先企業名 | 株式会社サンプル |
| industry | ○ | 業種（選択式） | 製造業 |
| target_departments | ○ | 対象部門（複数選択可） | 経理, 人事 |
| hearing_date | △ | ヒアリング予定日 | 2025-02-01 |
| purpose | △ | ヒアリング目的 | 初回商談 |

### 業種選択肢（14種）

```python
INDUSTRIES = [
    "製造業",
    "小売業",
    "卸売業",
    "建設業",
    "福祉・介護",
    "医療",
    "金融・保険",
    "不動産",
    "運輸・物流",
    "飲食・宿泊",
    "情報通信・IT",
    "その他サービス業",
    "農林水産業",
    "公共・団体"  # 農協・漁協・商工会など
]
```

### 部門選択肢（5種）

```python
DEPARTMENTS = [
    "経理",
    "人事・総務",
    "営業",
    "現場・製造",
    "情報システム"
]
```

## 出力Excel構成

### シート構成（動的）

| シート | 内容 | 生成条件 |
|--------|------|----------|
| 基本情報 | 会社概要、担当者情報、従業員数 | 常に生成 |
| IT環境 | 使用ツール・システム、インフラ | 常に生成 |
| 【部門名】 | 部門別ヒアリング項目 | 選択した部門ごと |
| 優先度・ゴール整理 | 課題優先度、理想の状態、予算感 | 常に生成 |

**例**: 経理・人事を選択した場合
1. 基本情報
2. IT環境
3. 経理
4. 人事・総務
5. 優先度・ゴール整理

## シート詳細設計

### シート1: 基本情報（共通）

```
┌─────────────────────────────────────────────────────────┐
│  ヒアリングシート                    日付: 2025/02/01  │
│  株式会社サンプル 様                                    │
├─────────────────────────────────────────────────────────┤
│ ■ 企業情報                                              │
│   会社名        [                                    ]  │
│   所在地        [                                    ]  │
│   設立年        [          ]  従業員数 [          ]名  │
│   事業内容      [                                    ]  │
│   年商規模      [                                    ]  │
├─────────────────────────────────────────────────────────┤
│ ■ 担当者情報                                            │
│   部署・役職    [                                    ]  │
│   氏名          [                                    ]  │
│   連絡先        [                                    ]  │
├─────────────────────────────────────────────────────────┤
│ ■ ヒアリング目的                                        │
│   □ 初回商談・現状把握                                  │
│   □ 特定課題の深掘り                                    │
│   □ DX/AI導入検討                                      │
│   □ その他 [                                        ]   │
└─────────────────────────────────────────────────────────┘
```

### シート2: IT環境（共通）

```
┌─────────────────────────────────────────────────────────┐
│ ■ 現在の使用ツール・システム                            │
├─────────────────────────────────────────────────────────┤
│ カテゴリ        │ ツール名     │ 導入年 │ 満足度(1-5) │
│ 会計ソフト      │ [        ]  │ [    ] │ [        ]  │
│ 勤怠管理        │ [        ]  │ [    ] │ [        ]  │
│ 顧客管理        │ [        ]  │ [    ] │ [        ]  │
│ グループウェア  │ [        ]  │ [    ] │ [        ]  │
│ ファイル共有    │ [        ]  │ [    ] │ [        ]  │
│ コミュニケーション │ [        ]  │ [    ] │ [        ]  │
│ 基幹システム    │ [        ]  │ [    ] │ [        ]  │
│ その他          │ [        ]  │ [    ] │ [        ]  │
├─────────────────────────────────────────────────────────┤
│ ■ IT環境                                                │
│   社内PC台数    [        ]台  ノートPC比率 [      ]%   │
│   サーバー      □ オンプレ  □ クラウド  □ ハイブリッド │
│   ネットワーク  □ 有線のみ  □ Wi-Fi完備  □ VPN利用    │
├─────────────────────────────────────────────────────────┤
│ ■ IT担当者                                              │
│   専任担当      □ いる（[    ]名） □ いない（兼任）   │
│   外部委託      □ あり [                           ]   │
│                 □ なし                                  │
└─────────────────────────────────────────────────────────┘
```

### シート3〜: 部門別ヒアリング（動的生成）

#### 経理部門

```
┌─────────────────────────────────────────────────────────┐
│ ■ 経理部門 ヒアリング                                   │
├─────────────────────────────────────────────────────────┤
│ ● 組織体制                                              │
│   経理担当者数  [        ]名                            │
│   決算期        [        ]月                            │
├─────────────────────────────────────────────────────────┤
│ ● 現在の業務フロー                                      │
│   請求書処理    □ 紙  □ Excel  □ システム  □ 電子    │
│   経費精算      □ 紙  □ Excel  □ システム            │
│   支払処理      □ 手動  □ 半自動  □ 自動              │
│   月次決算      所要日数 [        ]日                   │
├─────────────────────────────────────────────────────────┤
│ ● 困っていること（複数選択可）                          │
│   □ 請求書の手入力が多い                                │
│   □ 経費精算の承認フローが煩雑                          │
│   □ 月次決算に時間がかかる                              │
│   □ 部門間のデータ連携ができていない                    │
│   □ 紙の証憑管理が大変                                  │
│   □ インボイス制度対応                                  │
│   □ 電子帳簿保存法対応                                  │
│   □ その他 [                                        ]   │
├─────────────────────────────────────────────────────────┤
│ ● 具体的なエピソード・数値                              │
│   [                                                    ]│
│   [                                                    ]│
└─────────────────────────────────────────────────────────┘
```

#### 人事・総務部門

```
┌─────────────────────────────────────────────────────────┐
│ ■ 人事・総務部門 ヒアリング                             │
├─────────────────────────────────────────────────────────┤
│ ● 組織体制                                              │
│   人事担当者数  [        ]名                            │
│   年間採用数    [        ]名                            │
│   年間退職数    [        ]名                            │
├─────────────────────────────────────────────────────────┤
│ ● 現在の業務フロー                                      │
│   勤怠管理      □ 紙  □ Excel  □ タイムカード □ システム │
│   給与計算      □ 手計算  □ Excel  □ ソフト  □ 外注   │
│   入退社手続    □ 紙中心  □ 半デジタル  □ デジタル    │
│   評価制度      □ なし  □ 紙  □ Excel  □ システム    │
├─────────────────────────────────────────────────────────┤
│ ● 困っていること（複数選択可）                          │
│   □ 勤怠集計に時間がかかる                              │
│   □ 有給残日数の管理が煩雑                              │
│   □ 入退社時の手続きが属人化                            │
│   □ 採用管理ができていない                              │
│   □ 人事評価の運用が形骸化                              │
│   □ 社会保険手続きが大変                                │
│   □ 年末調整が紙で大変                                  │
│   □ その他 [                                        ]   │
├─────────────────────────────────────────────────────────┤
│ ● 具体的なエピソード・数値                              │
│   [                                                    ]│
└─────────────────────────────────────────────────────────┘
```

#### 営業部門

```
┌─────────────────────────────────────────────────────────┐
│ ■ 営業部門 ヒアリング                                   │
├─────────────────────────────────────────────────────────┤
│ ● 組織体制                                              │
│   営業担当者数  [        ]名                            │
│   顧客数        [        ]社                            │
├─────────────────────────────────────────────────────────┤
│ ● 現在の業務フロー                                      │
│   顧客管理      □ 名刺  □ Excel  □ CRM  □ その他      │
│   見積作成      □ 手書き  □ Excel  □ システム         │
│   受注管理      □ 紙  □ Excel  □ システム              │
│   日報・週報    □ なし  □ 紙  □ Excel  □ システム     │
├─────────────────────────────────────────────────────────┤
│ ● 困っていること（複数選択可）                          │
│   □ 顧客情報が属人化している                            │
│   □ 見積作成に時間がかかる                              │
│   □ 商談履歴が共有できていない                          │
│   □ 売上予測が立てられない                              │
│   □ 日報が形骸化している                                │
│   □ 営業ノウハウが共有できていない                      │
│   □ その他 [                                        ]   │
├─────────────────────────────────────────────────────────┤
│ ● 具体的なエピソード・数値                              │
│   [                                                    ]│
└─────────────────────────────────────────────────────────┘
```

#### 現場・製造部門

```
┌─────────────────────────────────────────────────────────┐
│ ■ 現場・製造部門 ヒアリング                             │
├─────────────────────────────────────────────────────────┤
│ ● 組織体制                                              │
│   現場作業者数  [        ]名                            │
│   シフト体制    □ 日勤のみ  □ 2交代  □ 3交代          │
├─────────────────────────────────────────────────────────┤
│ ● 現在の業務フロー                                      │
│   作業指示      □ 口頭  □ 紙  □ ホワイトボード □ システム │
│   実績入力      □ 紙  □ Excel  □ システム              │
│   在庫管理      □ 目視  □ 紙  □ Excel  □ システム     │
│   品質管理      □ 紙  □ Excel  □ システム              │
├─────────────────────────────────────────────────────────┤
│ ● 困っていること（複数選択可）                          │
│   □ 作業指示の伝達ミスがある                            │
│   □ 実績入力が二重になっている                          │
│   □ 在庫数が合わない                                    │
│   □ 設備の稼働状況が見えない                            │
│   □ 品質トラブルの原因追跡が難しい                      │
│   □ ベテランのノウハウが継承できない                    │
│   □ その他 [                                        ]   │
├─────────────────────────────────────────────────────────┤
│ ● 具体的なエピソード・数値                              │
│   [                                                    ]│
└─────────────────────────────────────────────────────────┘
```

#### 情報システム部門

```
┌─────────────────────────────────────────────────────────┐
│ ■ 情報システム部門 ヒアリング                           │
├─────────────────────────────────────────────────────────┤
│ ● 組織体制                                              │
│   IT担当者数    [        ]名（専任 [    ]名 / 兼任 [    ]名）│
├─────────────────────────────────────────────────────────┤
│ ● 現在の業務フロー                                      │
│   PC管理        □ 台帳なし  □ Excel  □ 資産管理ツール │
│   アカウント管理 □ 手動  □ 半自動  □ ID管理システム   │
│   ヘルプデスク  □ 口頭  □ メール  □ チケット管理      │
│   バックアップ  □ なし  □ 手動  □ 自動                │
├─────────────────────────────────────────────────────────┤
│ ● 困っていること（複数選択可）                          │
│   □ 問い合わせ対応に追われている                        │
│   □ IT資産の把握ができていない                          │
│   □ 入退社時のアカウント管理が煩雑                      │
│   □ セキュリティ対策が不十分                            │
│   □ システム間の連携ができていない                      │
│   □ 属人化で担当者不在時に困る                          │
│   □ その他 [                                        ]   │
├─────────────────────────────────────────────────────────┤
│ ● 具体的なエピソード・数値                              │
│   [                                                    ]│
└─────────────────────────────────────────────────────────┘
```

### 最終シート: 優先度・ゴール整理（共通）

```
┌─────────────────────────────────────────────────────────┐
│ ■ 優先度・ゴール整理                                    │
├─────────────────────────────────────────────────────────┤
│ ● 課題の優先順位（上位3つ）                             │
│   1. [                                              ]   │
│   2. [                                              ]   │
│   3. [                                              ]   │
├─────────────────────────────────────────────────────────┤
│ ● 理想の状態（1年後にどうなっていたいか）               │
│   [                                                    ]│
│   [                                                    ]│
├─────────────────────────────────────────────────────────┤
│ ● 予算感                                                │
│   □ 〜50万円  □ 50〜100万円  □ 100〜300万円            │
│   □ 300〜500万円  □ 500万円以上  □ 未定                │
├─────────────────────────────────────────────────────────┤
│ ● 希望スケジュール                                      │
│   着手希望時期  □ すぐ  □ 3ヶ月以内  □ 半年以内  □ 未定│
│   完了希望時期  [                                    ]   │
├─────────────────────────────────────────────────────────┤
│ ● 意思決定プロセス                                      │
│   決裁者        [                                    ]   │
│   検討体制      □ 担当者判断  □ 部長決裁  □ 役員決裁  │
├─────────────────────────────────────────────────────────┤
│ ● 次のステップ                                          │
│   □ 詳細ヒアリング（部門別）                            │
│   □ 現地調査・業務観察                                  │
│   □ 提案書作成                                          │
│   □ 見積依頼                                            │
│   □ その他 [                                        ]   │
└─────────────────────────────────────────────────────────┘
```

## 業種別カスタマイズ

### 業種特有の質問項目（自動追加）

業種を選択すると、関連する部門シートに追加質問が挿入される。

#### 製造業

**現場・製造部門に追加**:
- 生産管理システム: □ なし □ Excel □ 専用システム □ ERP
- 設備保全: □ 事後保全 □ 定期保全 □ 予知保全
- IoT導入状況: □ 未導入 □ 一部導入 □ 全面導入

**よくある課題**:
- □ 生産計画と実績の乖離
- □ 設備の突発故障
- □ 原価管理ができていない
- □ 多品種少量への対応

#### 小売業

**営業部門に追加**:
- POS連携: □ なし □ 売上データのみ □ 在庫連動
- EC展開: □ なし □ 検討中 □ 運用中
- 顧客分析: □ していない □ Excel □ BIツール

**よくある課題**:
- □ 在庫の過不足
- □ 顧客データの活用ができていない
- □ 実店舗とECの連携
- □ 人手不足・シフト管理

#### 福祉・介護

**全部門に追加**:
- 介護ソフト: [                    ]
- 国保連請求: □ 手作業 □ ソフト連携

**よくある課題**:
- □ 記録業務の負担が大きい
- □ 請求ミス・返戻が多い
- □ シフト作成が大変
- □ 職員の定着率が低い

#### 金融・保険

**全部門に追加**:
- コンプライアンス体制: □ 整備中 □ 運用中 □ 監査済
- 顧客対応記録: □ 紙 □ Excel □ CRM

**よくある課題**:
- □ 顧客対応履歴の管理
- □ コンプライアンス対応の負荷
- □ 帳票作成の手間
- □ 顧客情報のセキュリティ

#### 公共・団体（農協・漁協・商工会など）

**全部門に追加**:
- 組合員管理: □ 紙 □ Excel □ システム
- 共済・融資管理: □ 別システム □ 統合

**よくある課題**:
- □ 組合員情報の一元管理
- □ 複数事業のシステム分散
- □ 報告書作成の負荷
- □ 高齢化による人手不足

## デザイン仕様（Jony Iveデザイン哲学）

### 配色
- **メイン**: ブラック（#000000）- 見出し
- **グレー**: 
  - #333333 - 本文テキスト
  - #666666 - セクション見出し
  - #E0E0E0 - セパレーターライン、入力欄背景
- **アクセント**: #4A90E2（ブルー）- チェックボックス選択時のみ

### フォント（すべてメイリオで統一）
- **シートタイトル**: 16pt、太字
- **セクション見出し**: 12pt、太字
- **質問項目**: 10pt
- **入力欄**: 10pt

### レイアウト
- **列幅**: A列（ラベル）= 20、B列〜（入力）= 適宜調整
- **行の高さ**: 20〜25pt
- **余白**: 左右に余裕を持たせる
- **罫線**: 最小限（セクション区切りのみ）
- **入力セル**: 薄いグレー背景（#F5F5F5）で識別しやすく
- **グリッド線**: 非表示

## 使用方法

### 基本ワークフロー

1. **情報収集**: ユーザーに以下を確認
   - ヒアリング先企業名
   - 業種（14種から選択）
   - 対象部門（複数選択可）
   - ヒアリング予定日（任意）

2. **スクリプト実行**: `scripts/create_hearing_sheet.py`をカスタマイズして実行

3. **出力**: `/mnt/user-data/outputs/`にExcelを出力

### スクリプト実行例

```bash
python scripts/create_hearing_sheet.py \
  --company "株式会社サンプル" \
  --industry "製造業" \
  --departments "経理" "現場・製造" \
  --date "2025-02-01" \
  --output "ヒアリングシート_株式会社サンプル.xlsx"
```

### Pythonからの呼び出し

```python
create_hearing_sheet(
    company_name="株式会社サンプル",
    industry="製造業",
    departments=["経理", "現場・製造"],
    hearing_date="2025-02-01"
)
```

## 出力ファイル

- **形式**: Excel（.xlsx）
- **ファイル名**: `ヒアリングシート_{会社名}_{日付}.xlsx`
- **出力場所**: `/mnt/user-data/outputs/`

## 技術仕様

- **ライブラリ**: openpyxl（Python）
- **フォント**: メイリオ
- **用紙サイズ**: A4横向き推奨

## 活用シーン

1. **初回商談前の準備**
   - 事前に業種・部門を聞いておき、カスタマイズしたシートを持参
   
2. **現状把握ヒアリング**
   - 複数部門を横断的にヒアリングする際の漏れ防止

3. **提案書作成の基礎資料**
   - ヒアリング結果をそのまま提案書の「現状」セクションに転用

4. **案件管理**
   - 複数クライアントのヒアリング結果を比較・分析

---

## 自動記入機能（文字起こし → Excel記入）

### 概要

ヒアリングの文字起こしテキストを解析し、ヒアリングシートに自動記入する機能。非構造化インタビュー（自由に話してもらう形式）にも対応。

### 処理フロー

```
[入力]
  文字起こしテキスト（.txt / 直接貼り付け）
  ＋ 業種・部門の指定
      ↓
[Step 1] ヒアリングシート生成（create_hearing_sheet.py）
      ↓
[Step 2] 文字起こし解析（Claude API）
  - 発話内容を項目ごとに分類
  - 選択肢は最適なものをマッチング
  - 確信度を算出
      ↓
[Step 3] Excel自動記入（fill_hearing_sheet.py）
  - 値を記入
  - 確信度に応じてセル色変更
  - 低確信・複数候補はコメント付与
      ↓
[出力]
  記入済みExcel（.xlsx）
```

### 確信度とセル表現

| 確信度 | セル背景色 | コメント |
|--------|-----------|----------|
| high | なし（白） | なし |
| medium | 薄黄（#FFF9C4） | 推測根拠を記載 |
| low | 薄オレンジ（#FFE0B2） | 複数候補を記載 |
| none | 薄グレー（#F5F5F5） | 「該当発言なし」 |

### 使用方法

#### パターンA: 空シート生成 → 手動記入（従来通り）

```bash
python scripts/create_hearing_sheet.py \
  --company "株式会社サンプル" \
  --industry "製造業" \
  --departments "経理" "現場・製造"
```

#### パターンB: 文字起こしから自動記入

```bash
python scripts/fill_hearing_sheet.py \
  --company "株式会社サンプル" \
  --industry "製造業" \
  --departments "経理" "現場・製造" \
  --transcript transcript.txt
```

#### パターンC: 既存シートに文字起こしを適用

```bash
python scripts/fill_hearing_sheet.py \
  --input existing_sheet.xlsx \
  --transcript transcript.txt
```

### 解析対象項目

#### 基本情報シート
- 会社名、所在地、設立年、従業員数、事業内容、年商規模
- 担当者情報（部署・役職、氏名、連絡先）
- ヒアリング目的

#### IT環境シート
- 使用ツール・システム（会計、勤怠、顧客管理、グループウェア等）
- 各ツールの満足度
- IT環境（PC台数、サーバー構成、ネットワーク）
- IT担当者体制

#### 部門別シート
- 組織体制（人数、体制）
- 業務フロー（各業務の現状）
- 困っていること（チェックボックス自動選択）
- 具体的なエピソード（自由記述）

#### 優先度・ゴール整理シート
- 課題の優先順位
- 理想の状態
- 予算感
- 希望スケジュール
- 意思決定プロセス
- 次のステップ

### 選択肢のマッチングルール

文字起こし内の表現を、シートの選択肢に正規化してマッチング。

**例: 会計ソフト**
```
発話: 「うちはフリー使ってます」「freeeですね」「フリーの会計ソフト」
  ↓ マッチング
選択肢: "freee"
```

**例: 勤怠管理**
```
発話: 「タイムカードで打刻して」「紙のタイムカード」
  ↓ マッチング
選択肢: "タイムカード"
```

### 複数候補・曖昧な場合の処理

**複数候補がある場合**
```
発話: 「勤怠は...ジョブ何とかだったかな」
  ↓
記入値: "ジョブカン"
確信度: medium
コメント: "「ジョブ何とか」から推測。要確認"
```

**矛盾する発言がある場合**
```
発話A: 「Excelで管理してます」
発話B: 「最近システム入れたんですよ」
  ↓
記入値: "システム"
確信度: low
コメント: "Excel→システム移行中の可能性。要確認"
```

### 解析プロンプト

解析に使用するプロンプトは `references/extraction_prompt.md` を参照。
項目定義は `references/field_mappings.json` を参照。

### 出力例

**記入前**
```
| 会計ソフト    | [            ]   |
| 勤怠管理      | [            ]   |
```

**記入後**
```
| 会計ソフト    | freee            |  ← 白背景（確信度: high）
| 勤怠管理      | ジョブカン       |  ← 黄背景 + コメント（確信度: medium）
```

### 注意事項

1. **必ず人間が確認**: 自動記入結果は必ず人間がレビューすること
2. **黄色・オレンジのセル**: 確信度が低い項目。優先的に確認が必要
3. **空欄**: 該当する発言がなかった項目。追加ヒアリングの候補
4. **コメント**: Excelのコメント機能で補足情報を確認可能

---

## 関連スキル

- **業務フロー可視化ツール**（予定）: ヒアリング結果からフロー図を生成
- **PoC計画書生成**（予定）: 課題からPoC計画を作成
- **業務改善提案書**（予定）: ヒアリング結果から提案書を生成

## Resources

### scripts/
- `create_hearing_sheet.py`: ヒアリングシート生成のメインスクリプト
- `fill_hearing_sheet.py`: 文字起こしから自動記入するスクリプト

### references/
- `industry_questions.md`: 業種別質問項目の詳細
- `field_mappings.json`: 項目ID・選択肢の正規化定義
- `extraction_prompt.md`: 文字起こし解析用プロンプトテンプレート
