# 月次レポート作成 - フォーマットリファレンス

## 標準的なレポート構成

### 1. 表紙
- **タイトル**: 「月次活動レポート」（36pt、中央揃え）
- **対象期間**: 「YYYY年MM月」（18pt、グレー）
- **クライアント名**: 「○○株式会社 様」（14pt）
- **発行者名**: 「株式会社けんけん」（10pt、ライトグレー）

### 2. 活動サマリー（1ページ目）
- 当月の活動概要（2-3文）
- 稼働日数
- 主要な成果のハイライト

### 3. 主要活動内容（2ページ目）
- 実施した業務のリスト（頻度順）
- 業務内訳の円グラフ
- 具体的な活動内容

### 4. 成果と課題（3ページ目）
- 本月の主な成果（箇条書き）
- 課題・改善点（箇条書き）
- 対応状況

### 5. 次月の予定（3ページ目下部）
- 次月の計画（箇条書き）
- 注力ポイント

## デザインガイドライン（Jony Iveデザイン哲学）

### デザイン原則

**請求書・見積書と統一:**
- 極限までシンプルに
- 余白を贅沢に使う
- 完璧な整列
- 控えめな色使い（モノトーンのみ）
- 階層の明確化

### 色使い

**モノトーンの美学:**
- **ブラック（#000000）**: タイトル
- **ダークグレー（#333333）**: 本文テキスト
- **ミディアムグレー（#666666）**: 見出し
- **ライトグレー（#999999）**: 補足情報、日付
- **ペールグレー（#E0E0E0）**: セパレーターライン

### フォント（すべてメイリオ）
- **表紙タイトル**: 36pt、太字、ブラック
- **対象期間**: 18pt、グレー
- **見出し1**: 18pt、太字、ミディアムグレー
- **見出し2**: 14pt、太字、ミディアムグレー
- **本文**: 10pt、ダークグレー
- **補足情報**: 9pt、ライトグレー

### グラフスタイル
- **カラー**: グレースケールのみ（5段階）
- **背景**: 白
- **フォント**: Noto Sans CJK JP or メイリオ
- **サイズ**: 幅5インチ程度

## 日報データの構造

### 想定フォーマット（Excel/CSV）
```
日付 | 報告者 | 作業内容 | 課題 | 次回予定
2025-01-15 | 田中 | 戦略策定ミーティング | なし | レポート作成
2025-01-16 | 田中 | AI研修準備 | 資料不足 | 研修実施
```

### 必須カラム
- **日付**: YYYY-MM-DD形式
- **作業内容**: 実施した業務の内容

### オプションカラム
- **報告者**: 担当者名
- **課題**: 発生した課題
- **次回予定**: 次回の予定

## 自動集計項目

### 1. 稼働日数
- 作業内容が「休み」以外の日をカウント

### 2. 業務分類
以下のカテゴリに自動分類：
- **戦略策定・相談**: キーワード「戦略」「ミーティング」「相談」
- **研修・教育**: キーワード「研修」「教育」
- **資料作成**: キーワード「レポート」「資料」
- **定例会議**: キーワード「会議」「定例」
- **その他**: 上記以外

### 3. 主要業務（上位5件）
- 作業内容の出現頻度でランキング

### 4. 課題の抽出
- 課題カラムから空白以外を抽出

## カスタマイズ例

### クライアント別レポート
```python
create_monthly_report(
    client_name="株式会社サンプル",
    report_month="2025年2月"
)
```

### レポート内容のカスタマイズ
スクリプト内の以下を編集：
- 成果の記述
- 次月予定の内容
- グラフの種類

### 複数月のレポート作成
```python
for month in ["2025年1月", "2025年2月", "2025年3月"]:
    create_monthly_report(report_month=month)
```

## Google Drive連携（TODO）

### 実装予定機能
1. Google Drive APIで日報ファイル自動取得
2. 特定フォルダから最新ファイルを取得
3. 複数シートの統合

### 必要な設定
- Google Cloud Platform プロジェクト
- サービスアカウント
- 認証情報（JSON）

## グラフのカスタマイズ

### 円グラフ（タスク別配分）
```python
# 色のカスタマイズ
colors = ['#333333', '#666666', '#999999', '#CCCCCC', '#E0E0E0']

# サイズ調整
fig, ax = plt.subplots(figsize=(6, 4))
```

### 棒グラフ（週別稼働）
```python
# 週別の集計
weekly_data = df.groupby(df['日付'].dt.week).size()

# 棒グラフ作成
plt.bar(weeks, counts, color='#666666')
```

### 折れ線グラフ（稼働時間推移）
```python
# 日別の推移
plt.plot(dates, hours, color='#333333', linewidth=2)
```

## 出力ファイル

### Word形式（.docx）
- ファイル名: `月次レポート_YYYYMM.docx`
- 用途: 編集可能、クライアントに送付
- ページ数: 3-4ページ

## よくある質問

### Q1: 日報データがない月はどうする？
A: ダミーデータで動作確認。実際の運用では警告を表示。

### Q2: グラフが表示されない
A: matplotlibのフォント設定を確認。日本語フォントがない場合は英語で表示。

### Q3: クライアント情報を変更するには？
A: スクリプト上部の`REPORT_CONFIG`を編集。

### Q4: PDFでも出力したい
A: Wordファイルを手動でPDF変換、または`python-docx`から`pdf`変換ライブラリを追加。

### Q5: 自動送信は可能？
A: Gmail API等で自動送信機能を追加可能（今後の拡張）。

## 業務フロー

```
日報蓄積（daily-report-voice）
  ↓
Google Driveに保存
  ↓
月末に月次レポート作成
  ↓
内容確認・編集
  ↓
クライアントに送付
  ↓
継続契約の判断材料
```

## 今後の拡張予定

1. **Google Drive API実装** - 自動でファイル取得
2. **より高度な分析** - トレンド分析、前月比較
3. **PowerPoint版** - プレゼン用
4. **PDF自動変換** - 送付用
5. **自動送信機能** - Gmail API連携
6. **ダッシュボード** - Web版レポート
