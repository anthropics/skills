---
name: monthly-report-generator
description: 日報データから月次活動レポートを自動生成。Google Driveから日報を自動取得し、稼働日数・業務内訳・成果・課題を分析してWord形式のレポートを作成。Jony Iveデザイン（請求書・見積書と統一）。グラフ・チャート付き。「月次レポートを作成」「今月の活動報告を作って」等のリクエストで使用。顧客満足度向上・継続契約の判断材料に活用。
---

# Monthly Report Generator

## Overview

日報データから**A4縦2ページ**の月次活動レポートを自動生成するスキル。Google Driveから日報ファイルを自動取得し、稼働日数・業務内訳・成果・課題を分析。間延びせず、必要な情報をバランスよく2ページに収め、請求書・見積書と統一されたJony Iveデザインでプロフェッショナルな印象を提供。

**重要**: 必ず2ページに収まる設計。見てもらえる分量で、必要な情報を網羅。顧客満足度向上と継続契約の判断材料として活用。

## 使用方法

### 基本ワークフロー

1. **日報蓄積**: daily-report-voiceで日々の活動を記録
2. **月末に実行**: 月次レポート作成スクリプトを実行
3. **内容確認**: 生成された2ページのWordファイルを確認・微調整
4. **クライアント送付**: レポートを送付

### スクリプトのカスタマイズ

`scripts/create_monthly_report.py`の`REPORT_CONFIG`セクションを編集：

```python
REPORT_CONFIG = {
    "client_name": "合同会社大吉",
    "consultant_name": "株式会社けんけん",
    "report_month": datetime.now().strftime("%Y年%m月"),
}
```

### 実行方法

```bash
python scripts/create_monthly_report.py
```

## A4縦2ページのレポート構成

### 1ページ目（概要）

**ヘッダー**
- タイトル「月次活動レポート」（22pt、中央揃え）
- 対象月・クライアント名（11pt、中央揃え）

**稼働実績**
- 稼働日数・稼働時間（月額契約範囲内の表示）

**活動内訳（2カラムレイアウト）**
- 左：業務別の日数・割合リスト
- 右：円グラフ（業務内訳の視覚化）

**主要活動**
1. 生成AI活用戦略の策定
   - 現状分析と課題の整理
   - ユースケースの検討と優先順位付け
   - 6ヶ月のロードマップ作成

2. 従業員向けAI研修の実施
   - 基礎研修の実施（参加者数）
   - 実践ワークショップの開催
   - 個別相談対応

3. 月次レポート・資料作成
   - 月次活動レポートの作成
   - 社内向け資料の作成
   - 進捗報告資料の準備

### 2ページ目（詳細）

**成果**
✓ AI活用戦略の策定完了
   → 3つの重点ユースケースを特定
   → 6ヶ月のロードマップを作成
   → 経営陣への報告・承認完了

✓ 従業員研修の実施
   → 参加率95%（20/21名）を達成
   → 研修満足度4.5/5.0を獲得
   → 実践課題の提出率80%

✓ 業務自動化プランの提示
   → 月間40時間の削減見込み
   → 3業務の自動化を提案
   → ROI試算を提示

**課題と対応**
• 一部部署での活用が遅延
   → 追加説明会を次月第1週に実施予定

• セキュリティポリシーが未整備
   → 次月中にガイドライン策定を支援

• 効果測定指標の設定が必要
   → KPI設定のワークショップを実施予定

**次月の計画**
1. AI活用の効果測定・分析（KPI設定と測定開始）
2. フォローアップ研修の実施（希望者向け）
3. セキュリティガイドラインの策定支援
4. 追加ユースケースの検討
5. 月次定例会議での進捗報告

**フッター**
株式会社けんけん（中央揃え、控えめ）

## デザイン仕様（Jony Iveデザイン哲学）

### デザイン原則
**請求書・見積書と完全に統一**

1. **バランスの取れた情報密度** - 間延びせず、詰め込みすぎず
2. **2ページきっちり** - 必ず2ページに収まる設計
3. **余白の最適化** - 読みやすさを保ちつつコンパクト
4. **控えめな色使い** - グレーとブラックのみ
5. **階層の明確化** - フォントサイズで重要度を表現

### 配色
- **ブラック（#000000）**: タイトル
- **ダークグレー（#333333）**: 本文
- **ミディアムグレー（#666666）**: 見出し
- **ライトグレー（#999999）**: 補足情報
- **ペールグレー（#E0E0E0）**: セパレーター

### フォント（すべてメイリオ）
- **ヘッダータイトル**: 22pt、太字、ブラック
- **ヘッダー情報**: 11pt、グレー
- **見出し**: 13pt、太字、ミディアムグレー
- **サブ見出し**: 10pt、太字、ダークグレー
- **本文**: 9-9.5pt、ダークグレー
- **フッター**: 8pt、ライトグレー

### グラフスタイル
- **サイズ**: 6.5cm幅（コンパクト）
- **カラー**: グレースケール5段階
- **フォントサイズ**: 9pt

### 余白設定
- **ページ余白**: 上下2cm、左右2.5cm
- **段落間**: 最適化（間延び防止）
- **space_after**: セクションごとに細かく調整

## 日報データの自動集計

### Google Driveから自動取得
**TODO**: 現在はダミーデータで動作確認

### 自動集計項目

#### 1. 稼働日数・稼働時間
- 稼働日数カウント
- 稼働時間計算（1日8時間想定）

#### 2. 業務分類（5カテゴリ）
- 戦略策定（キーワード：「戦略」「ミーティング」）
- 研修（キーワード：「研修」）
- 資料作成（キーワード：「レポート」「資料」）
- 定例会議（キーワード：「会議」「定例」）
- その他

#### 3. 業務割合の計算
各業務の日数と割合（%）を自動計算

#### 4. 主要業務（上位3件）

## カスタマイズオプション

### 成果・課題・次月予定の編集
スクリプト内の該当箇所を編集：
```python
achievements = [
    ("AI活用戦略の策定完了", [
        "3つの重点ユースケースを特定",
        "6ヶ月のロードマップを作成",
        "経営陣への報告・承認完了"
    ]),
    # ...
]

issues = [
    ("一部部署での活用が遅延", "追加説明会を次月第1週に実施予定"),
    # ...
]

plans = [
    "AI活用の効果測定・分析（KPI設定と測定開始）",
    # ...
]
```

## 出力ファイル

### Word形式（.docx）
- ファイル名: `月次レポート_YYYYMM.docx`
- **ページ数: 2ページ** ← 必ず2ページに収まる
- 用途: クライアントに送付

## 技術仕様

- **ライブラリ**: python-docx、matplotlib、pandas
- **フォント**: メイリオ
- **用紙サイズ**: A4縦
- **ページ数**: 2ページ固定
- **余白**: 上下2cm、左右2.5cm
- **出力場所**: `/mnt/user-data/outputs/`

## バランス感の特徴

### 見てもらえる分量
✅ **1ページ目でパッと把握**：稼働実績、活動内訳、主要活動
✅ **2ページ目で詳細確認**：具体的な成果、課題と対応策
✅ **数値で説得力**：参加率、満足度、削減見込み時間
✅ **対応策まで記載**：課題だけでなく解決策も提示
✅ **間延びしない**：余白を最適化、2ページきっちり

### 1ページ版との違い
- 1ページ版：超簡潔、要点のみ
- 2ページ版：バランス重視、詳細も含む ✅

### 詳細版との違い
- 詳細版（5-7ページ）：情報量多すぎ、読まれにくい
- 2ページ版：適度な情報量、読まれやすい ✅

## 使用例

```bash
python scripts/create_monthly_report.py
```
→ 2ページの月次レポートを作成

## 業務フロー

```
【日々】
日報入力
  ↓
【月末】
2ページレポート作成（1分）
  ↓
微調整（3-5分）
  ↓
クライアント送付
  ↓
【効果】
読まれやすい（2ページ）
  ↓
顧客満足度向上
  ↓
継続契約
```

## Resources

### scripts/
- `create_monthly_report.py`: 2ページきっちり版レポート作成スクリプト

### references/
- `report_format.md`: フォーマット詳細説明
