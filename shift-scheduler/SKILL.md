---
name: shift-scheduler
description: ショッピングセンター・小売店向けシフト表自動生成スキル。月間シフト表をExcel形式で出力する。スタッフの希望休、スキル要件、労働基準法の制約を考慮した公平な自動割り当てを行う。「シフト表を作成」「来月のシフトを生成」「勤務表を作って」などのリクエストで起動。
---

# シフト表自動生成スキル

## 概要
スタッフ情報と制約条件から、公平で法令遵守のシフト表をExcel形式で生成する。

## 必須入力情報

ユーザーから以下を収集する（不足時は確認）:

1. **対象期間**: 年月（例: 2025年1月）
2. **スタッフリスト**: 名前、雇用形態（正社員/パート）、週の勤務可能日数
3. **シフトパターン**: 早番/遅番/通し等の時間帯定義
4. **希望休**: スタッフごとの休み希望日
5. **必要人数**: 各シフト・曜日ごとの最低配置人数

## 生成フロー

```
1. 入力データの整理・検証
2. scripts/generate_shift.py を実行
3. 出力されたExcelファイルを確認
4. 問題があれば調整して再生成
```

## スクリプト使用法

```bash
python scripts/generate_shift.py \
  --year 2025 --month 1 \
  --staff-file staff.json \
  --output shift_202501.xlsx
```

### staff.json フォーマット
```json
{
  "shifts": {
    "早番": {"start": "09:00", "end": "15:00"},
    "遅番": {"start": "14:00", "end": "21:00"}
  },
  "requirements": {
    "weekday": {"早番": 3, "遅番": 3},
    "weekend": {"早番": 4, "遅番": 4}
  },
  "staff": [
    {
      "name": "田中",
      "type": "full-time",
      "max_days_per_week": 5,
      "skills": ["レジ締め", "開店"],
      "ng_dates": ["2025-01-15", "2025-01-16"]
    }
  ]
}
```

## 出力Excel仕様

| シート名 | 内容 |
|---------|------|
| シフト表 | カレンダー形式の月間シフト表 |
| 集計 | スタッフ別の勤務日数・時間集計（**Excel関数で自動計算**） |
| 公平性チェック | 土日出勤回数、週労働時間の分析（**Excel関数で自動計算**） |

**重要**: 集計・公平性シートはExcel関数で実装されているため、シフト表を手動修正すると自動的に再計算されます。

## 制約・ルール

労働基準法と公平性のルールは `references/shift-rules.md` を参照。

主要ルール:
- 週40時間以内（正社員）
- 連続勤務は最大5日
- 週1日以上の休日確保
- 土日祝の出勤回数を均等化

## カスタマイズ対応

ユーザーの追加要件に応じて:
- シフトパターンの追加・変更
- 特定スキル保持者の必須配置
- 特定日の増員設定
- GASコード出力（リクエスト時のみ）
