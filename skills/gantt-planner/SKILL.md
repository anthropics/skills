---
name: gantt-planner
description: Создание и обновление графиков Ганта в Excel для строительных проектов. Используй когда пользователь говорит "построй график", "обнови Ганта", "спланируй работы", "КП", "календарный план", "график производства работ", "ППР", "вехи проекта".
---

# Gantt Planner — Планировщик графиков проекта

## Назначение

Создание профессиональных диаграмм Ганта в Excel для строительных и инфраструктурных проектов с учётом:
- Зависимостей между работами
- Критического пути
- Распределения ресурсов
- Вех (milestones)
- Сезонных ограничений (для северных регионов)

## Workflow

### Шаг 1: Сбор исходных данных

Запроси у пользователя:
1. **Источник данных:**
   - Контракт/договор (сроки, объёмы)
   - Техническое задание
   - Смета/ведомость объёмов работ
   - Существующий график (для обновления)

2. **Параметры проекта:**
   - Дата начала и окончания
   - Ключевые вехи (приёмка, ввод в эксплуатацию)
   - Ограничения (погода, сезонность, ресурсы)

### Шаг 2: Формирование WBS

Построй иерархическую структуру работ:

```
1. Подготовительный период
   1.1 Мобилизация техники
   1.2 Обустройство стройплощадки
   1.3 Геодезическая разбивка
2. Основной период
   2.1 Земляные работы
   2.2 Устройство основания
   2.3 Укладка покрытия
3. Завершающий период
   3.1 Благоустройство
   3.2 Демобилизация
   3.3 Сдача заказчику
```

### Шаг 3: Определение зависимостей

Типы связей:
- **FS (Finish-to-Start)** — стандартная (предыдущая заканчивается → следующая начинается)
- **SS (Start-to-Start)** — параллельный старт
- **FF (Finish-to-Finish)** — параллельное завершение
- **Lag** — задержка между работами

### Шаг 4: Расчёт критического пути

1. Определи длительность каждой работы
2. Рассчитай ранние и поздние сроки
3. Найди работы с нулевым резервом — это критический путь
4. Выдели критический путь красным цветом

### Шаг 5: Генерация Excel

Используй скилл **xlsx** для создания файла со структурой:

**Лист 1: Диаграмма Ганта**
| № | Код WBS | Наименование работ | Длительность | Начало | Окончание | Предшественник | Ресурсы | [Календарная шкала] |
|---|---------|-------------------|--------------|--------|-----------|----------------|---------|---------------------|

**Лист 2: Ресурсы**
| Ресурс | Тип | Доступность | Загрузка по периодам |
|--------|-----|-------------|----------------------|

**Лист 3: Вехи**
| № | Веха | Плановая дата | Фактическая дата | Статус |
|---|------|---------------|------------------|--------|

## Форматирование графика

### Цветовая кодировка:
- **Красный** — критический путь
- **Синий** — работы с резервом
- **Зелёный** — завершённые работы
- **Жёлтый** — текущие работы
- **Серый** — будущие работы
- **Ромб** — вехи (milestones)

### Масштаб времени:
- Для проектов <3 мес → дни
- Для проектов 3-12 мес → недели
- Для проектов >12 мес → месяцы

## Особенности для строительства

### Сезонность (ЯНАО, Арктика):
- Строительный сезон: июнь — август
- Зимний период: ограниченные работы
- Распутица: апрель-май, сентябрь-октябрь

### Типовые работы дорожного строительства:
1. Подготовка территории
2. Земляные работы (выемка, насыпь)
3. Устройство дорожной одежды
4. Укладка асфальтобетона
5. Обустройство (знаки, разметка, ограждения)
6. Благоустройство

## Примеры использования

### Пример 1: Новый график
```
Пользователь: Построй график для ремонта дороги 5 км, срок 3 месяца

Claude:
1. Анализирую типовой состав работ для дорожного ремонта
2. Формирую WBS из 15 работ
3. Устанавливаю зависимости
4. Рассчитываю критический путь
5. Генерирую Excel с диаграммой Ганта
```

### Пример 2: Обновление графика
```
Пользователь: Обнови график, земляные работы задержались на 2 недели

Claude:
1. Загружаю текущий график
2. Сдвигаю земляные работы на 2 недели
3. Пересчитываю зависимые работы
4. Проверяю влияние на критический путь
5. Генерирую обновлённый Excel
```

## Интеграция

- **xlsx** — для генерации Excel-файлов
- **progress-tracker** — для сопоставления план/факт
- **risk-analyzer** — для оценки рисков по срокам
- **1С:PM** — источник данных о проектах

## Шаблоны

Используй шаблоны из:
- `~/Desktop/Рабочие Проекты/05_Образование/Диплом MBA/Дипломная работа MBA/Приложения Excel/Диаграм Ганта Вехи.xlsx`
- `~/Desktop/Рабочие Проекты/05_Образование/Диплом MBA/Дипломная работа MBA/Приложения Excel/Гант Вехи.xlsx`

## Выходные документы

1. **График_проекта_[название]_[дата].xlsx** — основной файл
2. **Критический_путь_[название].xlsx** — анализ критического пути
3. **Ресурсная_гистограмма_[название].xlsx** — загрузка ресурсов
