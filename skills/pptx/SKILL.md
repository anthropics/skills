---
name: pptx
description: "每当以任何方式涉及 .pptx 文件时使用此技能 — 作为输入、输出或两者都包括。这包括：创建幻灯片组、推介文稿或演示文稿；读取、解析或从任何 .pptx 文件中提取文本（即使提取的内容将在其他地方使用，如电子邮件或摘要中）；编辑、修改或更新现有演示文稿；组合或拆分幻灯片文件；使用模板、布局、演讲者注释或评论。当用户提到"幻灯片组"、"幻灯片"、"演示文稿"或引用 .pptx 文件名时触发，无论他们之后打算如何处理内容。如果需要打开、创建或接触 .pptx 文件，请使用此技能。"
license: 专有。LICENSE.txt 包含完整条款
---

# PPTX 技能

## 快速参考

| 任务 | 指南 |
|------|-------|
| 读取/分析内容 | `python -m markitdown presentation.pptx` |
| 从模板编辑或创建 | 阅读 [editing.md](editing.md) |
| 从头开始创建 | 阅读 [pptxgenjs.md](pptxgenjs.md) |

---

## 读取内容

```bash
# 文本提取
python -m markitdown presentation.pptx

# 可视化概览
python scripts/thumbnail.py presentation.pptx

# 原始 XML
python scripts/office/unpack.py presentation.pptx unpacked/
```

---

## 编辑工作流程

**阅读 [editing.md](editing.md) 了解完整详细信息。**

1. 使用 `thumbnail.py` 分析模板
2. 解包 → 操作幻灯片 → 编辑内容 → 清理 → 打包

---

## 从头开始创建

**阅读 [pptxgenjs.md](pptxgenjs.md) 了解完整详细信息。**

当没有可用的模板或参考演示文稿时使用。

---

## 设计理念

**不要创建无聊的幻灯片。** 白色背景上的纯项目符号不会给任何人留下深刻印象。为每张幻灯片考虑此列表中的想法。

### 开始之前

- **选择大胆的、内容相关的调色板**：调色板应该感觉是为这个主题设计的。如果将您的颜色换到一个完全不同的演示文稿中仍然"可行"，说明您的选择不够具体。
- **主导地位优于平等**：一种颜色应该占主导地位（60-70% 的视觉权重），1-2 种支持色调和一种鲜明的强调色。永远不要给所有颜色相等的权重。
- **深/浅对比**：标题和结束幻灯片使用深色背景，内容使用浅色（"三明治"结构）。或者全程使用深色以获得高级感。
- **坚持视觉主题**：选择一个独特的元素并重复它 — 圆角图像框架、彩色圆圈中的图标、粗的单边边框。在每张幻灯片上延续它。

### 调色板

选择与您的主题相匹配的颜色 - 不要默认使用通用蓝色。使用这些调色板作为灵感：

| 主题 | 主色 | 辅助色 | 强调色 |
|-------|---------|-----------|--------|
| **午夜行政** | `1E2761`（海军蓝） | `CADCFC`（冰蓝） | `FFFFFF`（白色） |
| **森林与苔藓** | `2C5F2D`（森林） | `97BC62`（苔藓） | `F5F5F5`（奶油色） |
| **珊瑚能量** | `F96167`（珊瑚色） | `F9E795`（金色） | `2F3C7E`（海军蓝） |
| **暖赤陶** | `B85042`（赤陶色） | `E7E8D1`（沙色） | `A7BEAE`（鼠尾草） |
| **海洋渐变** | `065A82`（深蓝） | `1C7293`（青色） | `21295C`（午夜） |
| **炭黑极简** | `36454F`（炭黑） | `F2F2F2`（灰白色） | `212121`（黑色） |
| **青色信任** | `028090`（青色） | `00A896`（海泡） | `02C39A`（薄荷） |
| **浆果与奶油** | `6D2E46`（浆果） | `A26769`（玫瑰灰） | `ECE2D0`（奶油色） |
| **鼠尾草平静** | `84B59F`（鼠尾草） | `69A297`（桉树） | `50808E`（板岩） |
| **樱桃大胆** | `990011`（樱桃） | `FCF6F5`（灰白色） | `2F3C7E`（海军蓝） |

### 对于每张幻灯片

**每张幻灯片都需要一个视觉元素** — 图像、图表、图标或形状。纯文本幻灯片容易被遗忘。

**布局选项：**
- 双栏（左侧文本，右侧插图）
- 图标 + 文本行（彩色圆圈中的图标，粗体标题，下方描述）
- 2x2 或 2x3 网格（一侧图像，另一侧内容块网格）
- 半出血图像（全左或全右侧）带内容叠加

**数据显示：**
- 大型统计标注（大数字 60-72pt，下方小标签）
- 比较列（之前/之后，优/缺点，并排选项）
- 时间线或流程流程（编号步骤，箭头）

**视觉润色：**
- 章节标题旁边的小彩色圆圈图标
- 关键统计数据或标语使用斜体强调文本

### 字体

**选择有趣的字体配对** — 不要默认使用 Arial。选择有特色的标题字体并将其与干净的正文字体配对。

| 标题字体 | 正文字体 |
|-------------|-----------|
| Georgia | Calibri |
| Arial Black | Arial |
| Calibri | Calibri Light |
| Cambria | Calibri |
| Trebuchet MS | Calibri |
| Impact | Arial |
| Palatino | Garamond |
| Consolas | Calibri |

| 元素 | 大小 |
|---------|------|
| 幻灯片标题 | 36-44pt 粗体 |
| 章节标题 | 20-24pt 粗体 |
| 正文 | 14-16pt |
| 说明文字 | 10-12pt 静音 |

### 间距

- 最小边距 0.5"
- 内容块之间 0.3-0.5"
- 留出呼吸空间 — 不要填满每一寸

### 避免（常见错误）

- **不要重复相同的布局** — 在幻灯片之间变化列、卡片和标注
- **不要居中正文** — 左对齐段落和列表；仅居中标题
- **不要吝啬大小对比** — 标题需要 36pt+ 才能从 14-16pt 正文中脱颖而出
- **不要默认使用蓝色** — 选择反映特定主题的颜色
- **不要随机混合间距** — 选择 0.3" 或 0.5" 间隙并始终使用
- **不要设计一张幻灯片而其余保持简单** — 完全投入或始终简单
- **不要创建纯文本幻灯片** — 添加图像、图标、图表或视觉元素；避免纯标题 + 项目符号
- **不要忘记文本框内边距** — 将线条或形状与文本边缘对齐时，在文本框上设置 `margin: 0` 或偏移形状以考虑内边距
- **不要使用低对比度元素** — 图标和文本都需要与背景有强对比度；避免浅色背景上的浅色文本或深色背景上的深色文本
- **永远不要在标题下使用强调线** — 这是 AI 生成幻灯片的标志；使用空白或背景色代替

---

## 质量保证（必需）

**假设有问题。您的工作是找到它们。**

您的第一次渲染几乎从不正确。将 QA 视为错误搜索，而不是确认步骤。如果在第一次检查时发现零问题，说明您看得不够仔细。

### 内容 QA

```bash
python -m markitdown output.pptx
```

检查内容缺失、拼写错误、错误顺序。

**使用模板时，检查剩余的占位符文本：**

```bash
python -m markitdown output.pptx | grep -iE "xxxx|lorem|ipsum|this.*(page|slide).*layout"
```

如果 grep 返回结果，请在宣布成功之前修复它们。

### 视觉 QA

**⚠️ 使用子代理** — 即使只有 2-3 张幻灯片。您一直盯着代码，会看到您期望的内容，而不是实际内容。子代理有全新的眼光。

将幻灯片转换为图像（参见[转换为图像](#converting-to-images)），然后使用此提示：

```
目视检查这些幻灯片。假设有问题 — 找到它们。

查找：
- 重叠元素（文本穿过形状，线条穿过单词，堆叠元素）
- 文本溢出或在边缘/框边界处被切断
- 定位为单行文本但标题换行为两行的装饰线
- 源引用或页脚与上方内容冲突
- 元素太近（< 0.3" 间隙）或卡片/部分几乎接触
- 不均匀的间隙（一个地方有大空区域，另一个地方拥挤）
- 距幻灯片边缘的边距不足（< 0.5"）
- 列或类似元素未一致对齐
- 低对比度文本（例如，奶油色背景上的浅灰色文本）
- 低对比度图标（例如，深色背景上没有对比圆圈的深色图标）
- 文本框太窄导致过度换行
- 剩余的占位符内容

对于每张幻灯片，列出问题或关注区域，即使是次要的。

阅读并分析这些图像：
1. /path/to/slide-01.jpg（预期：[简要描述]）
2. /path/to/slide-02.jpg（预期：[简要描述]）

报告发现的所有问题，包括次要问题。
```

### 验证循环

1. 生成幻灯片 → 转换为图像 → 检查
2. **列出发现的问题**（如果没有发现问题，请更批判性地再次查看）
3. 修复问题
4. **重新验证受影响的幻灯片** — 一个修复通常会创建另一个问题
5. 重复直到完整的一轮没有发现新问题

**在完成至少一轮修复和验证循环之前，不要宣布成功。**

---

## 转换为图像

将演示文稿转换为单独的幻灯片图像以进行目视检查：

```bash
python scripts/office/soffice.py --headless --convert-to pdf output.pptx
pdftoppm -jpeg -r 150 output.pdf slide
```

这将创建 `slide-01.jpg`、`slide-02.jpg` 等。

修复后重新渲染特定幻灯片：

```bash
pdftoppm -jpeg -r 150 -f N -l N output.pdf slide-fixed
```

---

## 依赖项

- `pip install "markitdown[pptx]"` - 文本提取
- `pip install Pillow` - 缩略图网格
- `npm install -g pptxgenjs` - 从头开始创建
- LibreOffice (`soffice`) - PDF 转换（通过 `scripts/office/soffice.py` 为沙盒环境自动配置）
- Poppler (`pdftoppm`) - PDF 转图像
